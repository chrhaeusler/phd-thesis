\section{Introduction}

% higher visual areas higher visual areas
In the domain of higher-visual perception, functionally defined
category-selective brain regions, such as the \ac{ppa} \citep{epstein1998ppa},
the \ac{ffa} \citep{kanwisher1997ffa}, or \ac{eba} \citep{downing2001bodyarea}
exhibit significantly increased \ac{bold} activity correlated with a
``preferred'' \citep{debeck2008interpreting} stimulus class.
%
While the topographies (i.e. the location, size and shape) of these
category-selective areas are similarly distributed across individuals, the exact
topographies vary interindividually \citep{rosenke2021probabilistic,
zhen2017quantifying, zhen2015quantifying, frost2012measuring}.
% definition of localizer
To identify the topography of functional areas in individual persons,
block-design \textit{functional localizer} paradigms are traditionally used that
contrast modeled hemodynamic responses correlating with the corresponding
stimulus classes, such as landscapes, faces, or bodies.
% problem: one localizer for one domain
Functional localizers are designed to maximize detection power and thus limited
to mapping only one domain of brain functions, such as retinotopic visual areas
\citep{wang2015probabilistic}, category-selective regions
\citep{stigliani2015temporal}, theory of mind \citep{spunt2014validating}, or
semantic processes \citep{fedorenko2010new, fernandez2001language}.
% which gets messy
However, when mapping multiple functional domains in a limited amount of time is
desired, the "one paradigm for one domain of functions" approach becomes
impractical.
% localizer batteries: intro
To address this issue, researchers have attempted to create time-efficient,
multi-functional localizer batteries \textit{localizer batteries}
\citep[e.g.,][]{barch2013function, drobyshevsky2006rapid, pinel2007fast}.
% task based = shit
Nevertheless, the diagnostic quality of localizer paradigms heavily depends on a
participant's comprehension of the task instructions and general compliance, a
criterion that can be difficult to meet in clinical or pediatric populations
\citep{eickhoff2020towards, vanderwal2019movies}.

% ppa via audio-description Results also suggest that a naturally engaging,
% purely auditory paradigm like an audio-description could, in principle,
% substitute a visual localizer as a diagnostic procedure to assess brain
% functions in visually impaired % individuals \citep{haeusler2022processing}.
In \citet{haeusler2022processing}, we demonstrated that a functionally defined
region such as the \ac{ppa} can be localized using a model-driven \ac{glm}
analysis that is based on the annotated temporal structure of a two-hour long
naturalistic stimulus.
% full feature film is too long
However, for practical and monetary reasons, a two-hour long paradigm is
unsuitable for clinical applications.
% hence, predict from reference
One approach to reduce the time and costs is to identify a functional area in an
individual person's brain anatomy based on data collected from an independent
sample of different individuals (i.e. data from a \textit{reference group}).
% intro: estimation via common anatomical space
Previous studies have estimated the most probable location of a functional area
in an individual from a reference group by performing either a volume-based
\citep[e.g.,][]{zhen2017quantifying, zhen2015quantifying} or a surface-based
\citep[e.g.,][]{frost2012measuring, weiner2018defining,
rosenke2021probabilistic, wang2015probabilistic} \textit{anatomical alignment}.
%
First, in order to address the issue of anatomical variability across persons,
functional data of persons in the reference group are anatomically aligned to
(i.e.  projected into) a \textit{common anatomical space} (e.g., Montreal
Neurological Institute brain atlas; \citep[MNI152,][]{fonov2011unbiased}).
% project into test subject to estimate
Then, data are projected from the common anatomical space into\todo{?} the
individual person's brain anatomy to provide an estimate a functional region's
location.
% volume-based alignment in one sentence
Volume-based anatomical alignment \citep[s.][for a review]{klein2009evaluation}
aligns voxels to a three-dimensional common anatomical space \citep[e.g., MNI152
atlas;][]{fonov2011unbiased}.
% surface-based alignment in one sentence
Surface-based anatomical alignment \citep{fischl1999cortical, yeo2009spherical}
aligns vertices to a two-dimensional common anatomical space \citep[e.g.,
FreeSurfer's fsaverage template;][]{fischl1999high}.
% difference in one sentence
Whereas volume-based alignment does not account for individual sulcal and gyral
folding patterns, surface-based alignment respects interindividual variability
of the cortical surface.
% surface-based estimation works better
Consequently, previous studies that compared volume-based and surface-based
alignment to estimate the location of functional regions have shown that
surface-based alignment reduces inter-subject variability and improves
estimation performance \citep{rosenke2021probabilistic, frost2012measuring,
wang2015probabilistic, weiner2018defining}.
% remaining variability after surface-based alignment
However, even after surface-based alignment, the anatomical location of
functional regions varies between individuals \citep[e.g.,][]{coalson2018impact,
benson2014correction, natu2021sulcal, wang2015probabilistic, frost2012measuring,
langers2014assessment, weiner2014mid, rosenke2021probabilistic}.
% frost as an example
\citet{frost2012measuring}, for example, localized 13 functional areas of the
high-level visual cortex and ``found a large variability in the degree to which
functional areas respect macro-anatomical boundaries'' \citep[][p.
1369]{frost2012measuring}.
% functional--anatomical correspondence
The remaining variability indicates that functional areas a not necessarily
bound to anatomical landmarks, and reflects the degree of
\textit{functional--anatomical correspondence} between a brain function and its
underlying anatomical location.

% case of PPA cf. also \citet{frost2012measuring, rosenke2021probabilistic}
% \citet{weiner2018defining} showed ``that cortical folding patterns and
% probabilistic predictions reliably identify place-selective voxels in medial
% VTC across individuals and experiments''.
%
% However, ``this structural-functional coupling is not always perfect and there
% is inter-subject variability as to how much the place-selective voxels extend
% within the parahippocampal gyrus, as well as the lingual gyrus and medial
% aspects of the fusiform gyrus.
%
% Despite this inter-subject variability, place-selective voxels are always
%located within the collateral sulcus across participants.''
%\citep{weiner2018defining}.
In order to address the issue of functional-anatomical variability across
subjects, \textit{functional alignment} algorithms, such as
\textit{hyperalignment} \citep{haxby2011common, guntupalli2016model} or the
\textit{shared response model} (SRM) \citep{chen2015reduced,
zhang2016searchlight}, have been developed.
%
Whereas anatomical alignment aligns voxels (or vertices) that share the same
anatomical location to a common anatomical space, functional alignment aligns
voxels (or vertices) that share similar functional properties to a
\textit{common functional space} (CFS).
%
Functional alignment algorithms are typically used to compute both a
high-dimensional, functional brain template (i.e. the \ac{cfs}) subject-specific
transformations from the functional data of a study's participants.
%
A subject-specific transformation allows to project functional data from a
subject's three-dimensional voxel space into\todo{?} the \ac{cfs} or vice versa
\citep{haxby2020hyperalignment, kumar2020brainiak}.
%
The \ac{cfs} and transformations are calculated (i.e. \textit{trained}) by
maximizing the inter-subject similarity of \ac{bold} response time series
correlating with a time-locked external stimulation \citep{haxby2011common,
chen2015reduced, sabuncu2010function}, or by maximizing the inter-subject
similarity of connectivity profiles \citep{feilong2018reliable,
guntupalli2018computational, nastase2019leveraging}.
%
Whereas connectivity-based functional alignment better aligns connectivity
profiles, response-based functional alignment better aligns response time-series
\citep{guntupalli2018computational}.
%
Although functional alignment algorithms can be applied to \ac{fmri} time series
data from paradigms employing simplified stimuli, data from naturalistic stimuli
provide
%
improved generalizability of the \ac{cfs}
%
and transformations
%
to novel stimuli or tasks.
%
This is presumably because naturalistic stimuli sample a broader range of brain
states \citep{haxby2011common, guntupalli2016model}.

\todo[inline]{imo, validity (\& generalizability) of CFS and matrices are
non-separable claims!}

A more recent procedure \citep[e.g., ][]{jiahui2020predicting,
guntupalli2016model, haxby2011common} to estimate the most probable location of
a functional area in an individual from a reference performs an functional
alignment.
% solve functional-anatomical variability
First, the functional data of individuals in the reference group are
anatomically aligned to a common anatomical space.
%
Second, to address the issue of functional-anatomical variability across
individuals, the functional data are functionally aligned (i.e. projected into)
a \ac{cfs}.
%
Finally, data are projected from the \ac{cfs} into the\todo{?} individual's
brain anatomy, serving as an estimate of a functional region's location.
% Example: Jiahui (2020)
For instance, \citet{jiahui2020predicting} used surface-based hyperalignment to
calculate \acp{cfs} and transformations based on data from
%
the movie ``Grand Budapest Hotel'' ($\approx$\unit[50]{min}; \ac{tr}=\unit[1]{s}),
and
%
the movie ``Forrest Gump'' ($\approx$\unit[120]{min}; \ac{tr}=\unit[2]{s}).
%
\citet{jiahui2020predicting} then estimated $t$-contrast maps from a visual
localizer that aimed at identifying the \ac{ffa} by projecting the $t$-contrast
maps from a reference group through each \acp{cfs} into an individual's brain
anatomy.
%
Results showed that $t$-contrast maps from the visual localizer correlated more
highly with contrast maps that were estimated via hyperalignment than contrast
maps that were estimated via surface-based anatomical alignment.

% focus: ppa
Here again, we focus on the \ac{ppa} \citep[e.g.,][for
reviews]{epstein2014neural, aminoff2013role}, and investigate whether we can
estimate the results of $t$-contrasts (i.e. $Z$-maps) that were created to
identify the \ac{ppa} using functional data from three different paradigms as
the to predicted \textit{criteria}:
%
(a) a classic visual localizer \citep{sengupta2016extension} as the assumed
``gold standard'',
%
(b) a movie \citep{haeusler2022processing}, and
%
(c) an auditory narrative \citep{haeusler2022processing}.
% math stuff from citep{vodrahalli2018mapping} ``SRM learns $N$ maps $W_{i}$
% with orthogonal columns such that $||X_{i}-W_{i}S||_{F}$ is minimized over
% $\left\{ W_{i}\right\} _{i=1}^{N},S$, where $X_{i}\in\mathbb{R}^{v\times{T}}$
% is the $i^{th}$ subject's fMRI response ($v$ voxels by $T$ repetition times)
% and $S\in\mathbb{R}^{k\times{T}}$ is a feature time-series in a
% $k$-dimensional shared space'' \citep{vodrahalli2018mapping}.  Inverse vs.
% transpose of a matrix: for orthogonal transformations (like we should have
% here, i.e. only rotation, expansion) these two are one and the same thing:
% https://www.quora.com/When-is-the-inverse-of-a-matrix-equal-to-its-transpose
% why SRM
Our volume-based functional alignment approach utilizes the \ac{srm} algorithm
\citep{chen2015reduced, richard2019fast} as implemented in the open-source
software package BrainIAK \citep[Brain Imaging Analysis Kit;
\href{https://brainiak.org}{\url{brainiak.org}};][]{kumar2020brainiak,
kumar2020brainiaktutorial}.
% general overview of SRM
The \ac{srm} is an unsupervised probabilistic latent-factor model that
decomposes \ac{bold} \ac{fmri} response time series of participants who have
experienced the same stimulus into a \ac{cfs} of \textit{shared features}
\citep[also known as ``\textit{shared feature space}'';][]{chen2015reduced} and
subject-specific linear transformations.
% math stuff
More specifically, the \ac{srm} algorithm uses each $n^{th}$ subject's response
time series represented as matrix $X_{n}$ ({$v$} voxels by $t$ time points) to
compute the \ac{cfs} $C$ ($k$ shared responses by $t$ time points) and
subject-specific transformation matrices $W_{n}$ ($v$ voxels by $k$ shared
responses) with orthonormal columns ($W_{n}^{T}W_{n}=I_{k}$).
% iteratively fitted
The algorithm randomly initializes and fits the transformation matrices over
iterations to minimize the error in explaining the participants' data, while
also learning the time course of the shared responses (cf.
\href{https://brainiak.org/tutorials/11-SRM/}{\url{brainiak.org/tutorials/11-SRM}}).
% number of dimensions
In contrast to hyperalignment, the number of dimensions of the \ac{cfs} is not
set by the number of voxels, but rather it is determined by the researcher to a
number lower than the number of voxels, a procedure that also filters out noise
and reduces overfitting \citep{chen2015reduced}.
% phrase math in words
As a result, each shared feature can be thought of as a weighted sum of many
voxels across subjects \citep{kumar2020brainiak}.
% result = alignment
A subject-specific transformation matrix can be thought of as the weight of each
voxel in a subject's voxel space on each shared feature, and allows a
subject's\todo{?} functionally data to be aligned to the \ac{cfs} by projecting
responses within the voxels into\todo{?} the $k$-dimensional \ac{cfs}.


\todo[inline]{check if $W_{n}^{T}W_{n}=I_{k}$ is True}

\todo[inline]{biggest issue (for discussion, too): how to separate validity /
generalizability of CFS from validity / generalizability of transformation
matrices?}

% multi-paradigm model
In contrast to previous studies \citep[e.g.][]{jiahui2020predicting,
guntupalli2016model, haxby2011common} that calculated a \ac{cfs} based on data
from a single paradigm, we calculated a \textit{multi-paradigm \ac{cfs}} based
on data from three paradigms.
% cross-validation
We followed an exhaustive leave-one-subject-out cross-validation (N$=$14
subjects) to train a shared feature space (i.e. the \ac{cfs}) based on
concatenated response time series of
%
the movie ``Forrest Gump'' ($\approx$\unit[120]{min}; \ac{tr}=\unit[2]{s}),
%
the movie's audio-description  that was produced for a visually impaired
audience ($\approx$\unit[120]{min}; \ac{tr}=\unit[2]{s}), and
%
a visual localizer ($\approx$\unit[21]{min}; \ac{tr}=\unit[2]{s})
%
from $N-1$ \textit{training subjects} as seen in
Fig.~\ref{fig:multi-stimulus-cfs}.
% four aspects to explore
The purpose of this study was to investigate four aspects.
%
First, we explored the validity and generalizability of our multi-paradigm
\ac{cfs} by predicting a left-out \textit{test subject}'s results from the
analysis of
%
(a) the localizer \citep{sengupta2016extension} as the assumed ``gold
standard'',
%
(b) the movie \citep{haeusler2022processing}, and
%
(c) the auditory narrative \citep{haeusler2022processing}
%
serving as the criteria.
% three predictors
Second, we use a test subject's response time series from each of the three
paradigms separately in order to align the test subject with the corresponding
\acp{tr} within the \ac{cfs}.
%
This \textit{partial alignment} lets us assess the validity and generalizability
of the three paradigms serving as \textit{predictors} (i.e. one
\textit{cross-subject-within-paradigm prediction}, and two
\textit{cross-subject-cross-paradigm predictions}).
% partial alignment
Third, considering the impracticality of using a complete naturalistic stimulus
in a clinical setting to align a test subject, we also explored the relationship
between the estimation performance of the results from each of the three
paradigms and the quantity of data from each of the three paradigms used to
functionally align the subject with the multi-paradigm \ac{cfs}.
% benchmark: anatomical alignment the criteria
Fourth, we compared the performance of our volume-based, functional alignment
procedures to the performance of a volume-based, anatomical alignment approach
that serves as a benchmark.

\todo[inline]{add 2-3 sentences stating the results}
%
% Our results provide evidence that transformation matrices calculated based
% on data from naturalistic stimuli promise an increased validity of derived
% transformation for functional alignment over transformation matrices based on
% data (of the same!) paradigm based on simplified stimuli.

\todo[inline]{add 2-3 sentences stating a conclusion \& vision}
% Our results suggest that it is possible to ``scan once, estimate many

\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/multi-stimulus-cfs.pdf}
\caption{
%
    \textbf{Overview of the shared response model (SRM).
}
    %
    For each fold of the leave-one-subject-out cross-validation, each training
    subject's response time series of
    %
    the movie ($\approx$\unit[120]{min}; \ac{tr}=\unit[2]{s}),
    %
    the movie's audio-description ($\approx$\unit[120]{min};
    \ac{tr}=\unit[2]{s}),
    %
    and the visual localizer ($\approx$\unit[21]{min}; \ac{tr}=\unit[2]{s})
    %
    were concatenated to serve as input for the \ac{srm} algorithm.
    %
    From these response time series represented as matrix $X_{n}$ ({$v$} voxels
    by $t$ time points), the algorithm calculates the common functional
    space (CFS) $C$ ($k$ shared features by $t$ time points) and
    subject-specific transformation matrices $W_{n}$
    ($v$ voxels by $k$ shared features) with orthonormal columns
    ($W_{n}^{T}W_{n}=I_{k}$).
} \label{fig:multi-stimulus-cfs} \end{figure*}





\section{Methods}

% we get the data from the naturalistic PPA paper (its subdataset) datalad get
% -n inputs/studyforrest-ppa-analysis/inputs/studyforrest-data-aligned datalad
%  get
%  inputs/studyforrest-ppa-analysis/inputs/studyforrest-data-aligned/sub-??/in\_bold3Tp2/sub-??\_task-a?movie\_run-?\_bold*.*

% reference to PPA-Paper
For the current study, we used the same subset of the studyforrest dataset that
we previously used in \citet{haeusler2022processing}:
%
The sample included the same fourteen participants who
% VIS
(a) participated in a dedicated six-category block-design visual localizer
\citep{sengupta2016extension},
% AV
(b) watched the audio-visual movie ``Forrest Gump''
\citep{hanke2016simultaneous}, and
% AD
(c) listened to the movie's audio-description \citep{hanke2014audiomovie}.
% see corresponding papers for details
An exhaustive description of the participants, stimulus creation, procedure,
stimulation setup, and fMRI acquisition can be found in the corresponding
publications, while a summary is provided in \citet{haeusler2022processing}.



\subsection{Preprocessing}

% data sources
The analyses in this study were conducted on the same preprocessed fMRI data he
current analyses were carried out on the same preprocessed fMRI data (s.
\href{https://github.com/psychoinformatics-de/studyforrest-data-aligned
}{\url{github.com/psychoinformatics-de/studyforrest-data-aligned}}) that were
used for
%
(a) the technical validation of the dataset \citep{hanke2016simultaneous},
%
(b) the localization of higher-visual areas \citep{sengupta2016extension}, and
%
(c) the investigation of responses of the \ac{ppa} correlating with naturalistic
spatial information in \citep{haeusler2022processing}.
%
We reran the preprocessing and analyses steps performed in
\citet{sengupta2016extension} and \citet{haeusler2022processing} using FEAT
v6.00 \citep[FMRI Expert Analysis Tool;][]{woolrich2001autocorr} as shipped with
FSL v5.0.9 \citep[\href{https://www.fmrib.ox.ac.uk/fsl}{FMRIB's Software
Library;}][]{smith2004fsl} to reproduce the time series that served as input for
the previous statistical analyses and their results (i.e. the statistical
$Z$-maps).
% temporal filtering
The preprocessing steps included high-pass temporal filtering (using a
Gaussian-weighted least-squares straight line) for every run of the visual
localizer (cutoff period of \unit[100]{s}), and every segment of the movie and
audio-description (cutoff period of \unit[150]{s}).
% brain extraction & spatial smoothing
Brain extraction was performed using BET \citep{smith2002bet}., and data from
all three paradigms were spatially smoothed using a Gaussian kernel with a full
width at half maximum of \unit[4.0]{mm}.
% grand mean normalization
A grand-mean intensity normalization was applied to each run of the functional
localizer and each segment of the naturalistic stimuli.
%
Further analyses on these reproduced times series were performed using Python
scripts that relied on
%
NiBabel v3.2.1 (\href{https://nipy.org}{\url{nipy.org}}),
%
NumPy v1.20.2 (\href{https://numpy.org}{\url{numpy.org}}),
%
Pandas v1.2.3 (\href{https://pandas.pydata.org}{\url{pandas.pydata.org}}),
%
Scipy v1.6.2 (\href{https://scipy.org}{\url{scipy.org}}),
%
scikit-learn v1.0 (\href{https://scikit-learn.org}{\url{scikit-learn.org}}),
%
BrainIAK v0.11
\citep[\href{https://brainiak.org}{\url{brainiak.org}}][]{kumar2020brainiak,
kumar2020brainiaktutorial},
%
Matplotlib v3.4.0 (\href{https://matplotlib.org}{\url{matplotlib.org}}),
%
seaborn v0.11.2 (\href{https://seaborn.pydata.org}{\url{seaborn.pydata.org}}),
%
and calling command line functions of FSL.

%\paragraph{Fixing FSL output}

% grand_mean_for_4d.py (formerly: data_normalize_4d.py):
% is not necessary anymore: FSL has applied grand mean scaling to
% 'filtered_func_data.nii.gz'

% input: 'sub-*/run-?.feat/filtered_func_data.nii.gz' (of VIS, AO & AV)
% output: saved to 'sub-??_task-*_run-?_bold_filtered.nii.gz'

% FSL adds back the mean value for each voxel's time course at the end of the
% preprocessing;
% hence, the script substracts that mean again but multiplies it by 10000
% (like FSL does it, too)

% definition of grand mean scaling for 4d data:
% voxel values in every image are divided by the average global mean
% intensity of the whole session. This effectively removes any mean global
% differences in intensity between sessions.

% FSL User Guide:
% filtered_func_data will normally have been temporally high-pass filtered,
% it is not zero mean; the mean value for each voxel's time course has been
% added back in for various practical reasons.
% When FILM begins the linear modeling, it starts by removing this mean.

% masks-from-mni-to-bold3Tp2.py:
% - merges unilateral ROIs overlaps (already in MNI) to bilateral ROI
% - output: 'masks/in_mni/PPA_overlap_prob.nii.gz'
% - warps union of ROIs from MNI into each subjects space
% output: 'sub-*/masks/in_bold3Tp2/grp_PPA_bin.nii.gz' + audio_fov.nii.gz dilate
% the ROI masks by 1 voxel; output: 'grp_PPA_bin_dil.nii.gz'

% masks-from-mni-to-bold3Tp2.py:
% warp MNI masks into individual bold3Tp2 spaces

% masks-from-t1w-to-bold3Tp2.py:
% transforms 'inputs/tnt/sub-*/t1w/brain_seg*.nii.gz'
% into individual's bold3Tp2
% output: 'sub-*/masks/in_bold3Tp2/brain_seg*.nii.gz'

% mask-builder-voxel-counter.py:
% builds different individual masks by dilating, merging other masks
% creates a FoV of AO stimulus for every subject from 4d time-series of AO run
% output: sub-*/masks/in_bold3Tp2/audio_fov.nii.gz'
% counts the voxels
% long story short: we cannot used all gyri that contain PPA to some degree
% even if the mask by FoV of AO stimulus and individual gray matter mask

% data_mask_concat_runs.py:
% masks are not dilated and not masked with subject-specific gray matter mask
% outputs:
% 'sub-*_task_aomovie-avmovie_run-1-8_bold-filtered.npy
% 'sub-*_task_visloc_run-1-4_bold-filtered.npy'

% reason why we do it
The \ac{srm} requires that the number of samples (i.e. the number of \acp{tr})
exceed the number of features (the number of voxels).
%
In order to restrict the number of voxels, we created bilateral \acp{roi} for
each subject.
%
Specifically, we warped the union of individual \acp{ppa}
\citep[s.][]{haeusler2022processing} from MNI space into each subject's voxel
space using subject-specific, non-linear transformation matrices that were
previously computed
\citep[][\href{https://github.com/psychoinformatics-de/studyforrest-data-templatetransforms
}{\url{github.com/psychoinformatics-de/studyforrest-data-templatetransforms}}]{hanke2014audiomovie}.
% applying masks
The time series data of each subject were then masked in their native voxel
space by the union of individual \acp{ppa} and the subject-specific \ac{fov} of
the audio-description.
% voxels = [1665, 1732, 1400, 1575, 1664, 1951, 1376, 1383, 1683, 1887, 1441,
% 1729, 1369, 1437] median = 1619.5
The number of remaining voxels per subject (range 1369--1951,
$\overline{X}=1592$, $SD=188$) can be seen in Fig.~\ref{fig:plot_voxel-counts}.
% normalization
Data of each run were normalized ($z$-scored) to a mean of zero
($\overline{X}=0$) and a standard deviation of one ($SD=1$).
%
Due to an image reconstruction problem \citep[cf.][]{hanke2014audiomovie}, the
last 75 \acp{tr} of the audio-description were missing in subject 04.
%
The \ac{srm} allows for different numbers of voxels across subjects, but the
number of \acp{tr} must be the same.
%
Consequently, we removed the last 75 \acp{tr} of the audio-description from the
time series of all other subjects.
% summary; AO + AV = 7123 TRs (not 7198 TRs anymore); localizer has 4 x 156 TRs
As a result, the data used to fit the \ac{srm} in the next step included 3599
\acp{tr} from the movie, 3524 \acp{tr} from the audio-description, and 624
\acp{tr} from the visual localizer experiment (7747 \acp{tr} in total).
%% concatenate and z-score
The time series of all three paradigms were concatenated and $z$-scored.

\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/plot_voxel-counts.pdf}
\caption{
%
\textbf{Number of voxels in the bilateral regions of interest (ROIs)
of each subject.}
%
In order to reduce the number of voxels, we warped the union of
individual \acp{ppa} \citep[cf. Fig. 1 in][]{haeusler2022processing} from
MNI152 space into each subject's native voxel space.
%
The remaining voxels of each subject were further constrained to those
voxels that are included in the respective subject's \ac{fov} of the
audio-description \citep[cf.][]{hanke2014audiomovie}.
}
\label{fig:plot_voxel-counts}
\end{figure*}


\begin{comment}

The number of remaining voxels per subject can be seen in Table
\ref{tab:ppamaskvoxels} (range 1369--1951, $\overline{X}=1592$, $SD=188$).


\begin{table*}[btp] \caption{
%
\textbf{Table heading.}
%
The number of remaining voxels after masking time series data of each paradigm
and subject with the union of individual \acp{ppa} warped from MNI space
into each individual's subjects-space and the subject-specific field of view
of audio-description.
    }

\label{tab:ppamaskvoxels}
\begin{tabular}{ll}
\toprule
\textbf{Subject} & \textbf{no. of voxels} \\
\midrule
sub-01 & 1665 \tabularnewline
sub-02 & 1732 \tabularnewline
sub-03 & 1400 \tabularnewline
sub-04 & 1575 \tabularnewline
sub-05 & 1664 \tabularnewline
sub-06 & 1951 \tabularnewline
sub-14 & 1376 \tabularnewline
sub-09 & 1383 \tabularnewline
sub-15 & 1683 \tabularnewline
sub-16 & 1887 \tabularnewline
sub-17 & 1441 \tabularnewline
sub-18 & 1729 \tabularnewline
sub-19 & 1369 \tabularnewline
sub-20 & 1437 \tabularnewline
\bottomrule
\end{tabular}
    % \caption*{The legend text goes here.}
\end{table*}

\end{comment}




\subsection{Estimation via functional alignment}

\subsubsection{Overview}
%
To estimate the empirical $Z$-maps for $t$-contrasts using functional alignment,
we followed a four-step procedure.
% create CFS and training subjects' matrices
First, for every fold of a leave-one-out cross-validation (N$=$14 subjects), we
trained a \ac{srm} on $N-1$ training subjects' response time series of the
movie, the audio-description, and the visual localizer.
% results in...
This step generated a \ac{cfs} for each fold of the cross-validation and an
orthonormal transformation matrix for each training subject.
% align test subject
Second, we aligned the test subject to the corresponding \acp{tr} within the
\ac{cfs} using time series data from the visual localizer, the movie, or the
audio-description.
%
Second, we aligned the test subject's time series data from the movie,
audio-description, and visual localizer paradigms separately to the
corresponding TRs within the \ac{cfs}.
%
This step produced different transformation matrices for the test subject based
on data from different paradigms.
% quantity vs. performance
In order to examine the relationship between estimation performance and the
amount of data used to generate a transformation matrix, we also varied the
number of runs of the paradigms.
%
This step produced transformation matrices based on an increasing number of runs
per paradigm.
%
In the third step, we mapped the training subjects' empirical $Z$-maps from
their voxel space into the \ac{cfs} using their transformation matrices.
% project from CFS into test subject
Finally, we projected the training subjects' $Z$-maps from the \ac{cfs} into the
test subject's voxel space using the transpose of the test subject's
transformation matrix.
% actual prediction
We obtained the test subject's predicted $Z$-maps by calculating the arithmetic
mean of the projected Z-maps



\subsubsection{Fitting the SRM}
%
In order to obtain the \ac{cfs} and the training subjects' transformation
matrices, we used the probabilistic \ac{srm} algorithm that is implemented in
BrainIAK v.11 \citep[Brain Imaging Analysis Kit;][]{kumar2020brainiak,
kumar2020brainiaktutorial}, and approximates the \ac{srm} based on the
Expectation Maximization (EM) algorithm as proposed by \citet{chen2015reduced}
and optimized by \citet{anderson2016enabling}.
% number of dimensions / features ``The effect of number of PCs on BSC was
% similar for models that were based only on Princeton (n = 10) or Dartmouth (n
% = 11) data, suggesting that this estimate of dimensionality is robust across
% differences in scanning hardware and scanning parameters''
% \citep{haxby2011common}.
%
% ``These dimensionality estimates are a function of the spatial and temporal
% resolution of fMRI and the number and variety of response vectors used to
% derive the common space'' \citep{guntupalli2016model}.
%
% ``The true dimensionality of representation in human cortex surely involves
% vastly more distinct tuning functions. Estimates of the dimensionality of
% cortical representation, therefore, will almost certainly be much higher as
% data with higher spatial and temporal resolution for larger and more varied
% samples of response vectors are used to build new common models''
% \citep{guntupalli2016model}.
We chose a value of $k=10$ for the number of shared features (i.e. the number of
dimensions in the \ac{cfs}) based on the temporal and spatial resolution of our
data (\ac{tr} = \unit[2]{s}; \unit[2.5 $\times$ 2.5 $\times$ 2.5]{mm}), the
average number of voxels per \ac{roi}, and findings from
\citet{haxby2011common}.
%
\citet{haxby2011common} used hyperalignment to create a \ac{cfs} of 1,000
dimensions based of functional data (\ac{tr} = \unit[3]{s}) of voxels (\unit[3
$\times$ 3 $\times$ 3]{mm}) located in the ventral temporal cortex.
%
Then, \citet{haxby2011common} reduced the dimensionality of the \ac{cfs} by
applying a \ac{pca} in order to determine the subspace that is sufficient to
capture the full range of response-pattern distinctions.

They then applied principal component analysis \ac{pca} to reduce the
dimensionality of the \ac{cfs} to determine the subspace that sufficiently
captured the range of response-pattern distinctions.
%
Furthermore, the cortical topographies of category-selective brain regions were
preserved in the 35-dimensional \ac{cfs}.
% ...as judged by visual inspection
In the present study, we also computed \acp{cfs} of $k=5, 20, 30, 40, 50$ but
prediction performance based on these \acp{cfs} barely varied from a
10-dimensional \ac{cfs}.
% iterations:
The algorithm was set to iterate 30 times to minimize the error.

% correlations of regressors
In order to visualize characteristics of the \ac{cfs}, we calculated the Pearson
correlation coefficients between the shared responses and the regressors that
were previously modeled \citep[cf.][]{sengupta2016extension,
haeusler2022processing} to investigate hemodynamic responses during the three
paradigms.
%
As an example, we chose the \ac{cfs} that was created in the first fold of the
cross-validation from $N-1$ subjects to estimate $Z$-maps of subject 01.
%
The time series of the shared features were trimmed to match the corresponding
\acp{tr} of the respective paradigms.
%
Fig.~\ref{fig:corr-vis-reg-srm} shows the correlations between regressors
created to model hemodynamic responses during the visual localizer and shared
responses (trimmed to \acp{tr} that match the visual localizer).
Fig.~\ref{fig:corr-av-reg-srm} shows the correlations between regressors created
to model hemodynamic responses during the movie \citep[cf. Table 3
in][]{haeusler2022processing} and shared responses, while
Fig.~\ref{fig:corr-ao-reg-srm} shows the correlations between regressors created
to model hemodynamic responses during the audio-description \citep[cf. Table 3
in][]{haeusler2022processing} and shared responses.


\todo[inline]{what do the plots suggest?}

\todo[inline]{make colors of non-used TRs more transparent (alpha=15)}

% shuffle runs
As a negative control, we randomly shuffled the order of runs of the visual
localizer and the segments of the naturalistic stimuli separately for each
paradigm and training subject. We then concatenated the time series, fit the
\ac{srm}, and calculated the Pearson correlation coefficients.
%
We expected that the \ac{srm} algorithm would fail to fit ``meaningful''
\todo{??} shared responses to randomly shuffled training data.
%
As hypothesized, the results based on shuffled time series revealed no or only
minor correlations between the shared responses and regressors, as shown in
Fig.~\ref{fig:corr-vis-reg-srm-shuffled},
Fig.~\ref{fig:corr-av-reg-srm-shuffled}, and
Fig.~\ref{fig:corr-ao-reg-srm-shuffled}.


\todo[inline]{Plots are located in the appendix; add representation of the model
to the plots}


\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/corr_vis-regressors-vs-cfs_sub-01_srm-ao-av-vis_feat10-iter30_7123-7747.pdf}
\caption{
%
\textbf{Pearson correlation coefficients between regressors of the visual
localizer and shared features.}
%
The time series of the shared features within the multi-paradigm \ac{cfs}
%
(as calculated for subject 01 in the first fold of the cross-validation)
%
were trimmed to match the corresponding \acp{tr} of the visual localizer
paradigm \citep{sengupta2016extension}.
%
The six regressors of the visual localizer model hemodynamic responses to
the six categories of pictures that were presented in blocks.
}
\label{fig:corr-vis-reg-srm}
\end{figure*}


\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/corr_av-regressors-vs-cfs_sub-01_srm-ao-av-vis_feat10-iter30_3524-7123.pdf}
\caption{
    %
    \textbf{Pearson correlation coefficients between regressors of the movie
    and shared features}
    %
    The time series of the shared features within the multi-paradigm \ac{cfs}
    %
    (as calculated for subject 01 in the first fold of the cross-validation)
    %
    were trimmed to match the corresponding \acp{tr} of the movie
    \citep{hanke2016simultaneous}.
    %
    The regressors \texttt{vse\_new} to \texttt{vno\_cut} are based on
    annotations movie frames, whereas the regressors
    \texttt{fg\_av\_ger\_lr} to \texttt{fg\_av\_ger\_ud} represent low-level
    visual or auditory confounds
    \citep[cf. Table 3 in][]{haeusler2022processing}.
    %
    \texttt{vse\_new}: change of the camera position to a setting not depicted
    before;
    \texttt{vse\_old}: change of the camera position to a recurring setting;
    %
    \texttt{vlo\_ch}: change of the camera position to another locale within
    the same setting;
    %
    \texttt{vpe\_new}: change of the camera position within a locale not
    depicted before;
    %
    \texttt{vpe\_old}: change of the camera position within a recurring locale;
    %
    \texttt{vno\_cut}: frames within a continuous movie shot;
    %
    \texttt{fg\_av\_ger\_lr}: left-right luminance difference;
    %
    \texttt{fg\_av\_ger\_lrdiff}: left-right volume difference;
    %
    \texttt{fg\_av\_ger\_ml}: mean luminance;
    %
    \texttt{fg\_av\_ger\_pd}: perceptual difference;
    %
    \texttt{fg\_av\_ger\_rms}: root mean square volume;
    %
    \texttt{fg\_av\_ger\_ud}: upper-lower luminance difference.
    }
\label{fig:corr-av-reg-srm}
\end{figure*}


\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/corr_ao-regressors-vs-cfs_sub-01_srm-ao-av-vis_feat10-iter30_0-3524.pdf}
\caption{
    %
    \textbf{Pearson correlation coefficients between regressors of the
    audio-description and shared features.}
    %
    The time series of the shared features within the multi-paradigm \ac{cfs}
    %
    (as calculated for subject 01 in the first fold of the cross-validation)
    %
    were trimmed to match the corresponding \acp{tr} of the
    audio-description \citep{hanke2014audiomovie}.
    %
    The regressors \texttt{body} to \texttt{sex\_m} are based on
    annotated classes of nouns spoken by the audio-description's narrator,
    whereas the regressors \texttt{fg\_ad\_ger\_lrdiff} and
    \texttt{fg\_ad\_ger\_rms} represent low-level auditory confounds
    \citep[cf. Table 3 in][]{haeusler2022processing}.
    %
    \texttt{body}: trunk of the body; overlaid clothes;
    %
    \texttt{bpart}: limbs and trousers;
    %
    \texttt{fahead}: (parts) of the face or head;
    %
    \texttt{furn}: moveable furniture (insides \& outsides);
    %
    \texttt{geo}: immobile landmarks;
    %
    \texttt{groom}: rooms \& locales or geometry-defining elements;
    %
    \texttt{object}: moveable and countable entities with firm boundaries;
    %
    \texttt{se\_new}: a setting occurring for the first time;
    %
    \texttt{se\_old}: a recurring setting;
    %
    \texttt{sex\_f}: female name, female person(s);
    %
    \texttt{sex\_m}: male name, male person(s);
    %
    \texttt{fg\_ad\_lrdiff}: left-right volume difference;
    %
    \texttt{fg\_ad\_rms}: root mean square volume.
    %
    \texttt{geo\&groom} is a combination of regressors as used on the positive
    side of the primary contrasts aimed to localize the \ac{ppa}
    \citep[cf. Table 5 in][]{haeusler2022processing}.
    }
\label{fig:corr-ao-reg-srm}
\end{figure*}


\subsubsection{Alignment of the test subject}

% AO: 0-451, 0-892, 0-1330, 0-1818, 0-2280, 0-2719, 0-3261, 0-3524
% AV: 3524-3975, 3524-4416, 3524-4854, 3524-5342, 3524-5804, 3524-6243,
%     3524-6785, 3524-7123
% AO+AV: 0-7123

% in-code documentation of
% https://github.com/brainiak/brainiak/blob/master/brainiak/funcalign/srm.py
% says: # Solve the Procrustes problem; A =
% subjectFMRIdata.dot(SharedResponses.T) U, \_, V = np.linalg.svd(A,
% full\_matrices = False) return U.dot(V)

%
We aligned the test subject's response time series from the visual localizer,
the movie, or the audio-description to the corresponding \acp{tr} within the
\ac{cfs} by factorizing the response time series data via singular value
decomposition.
%
This step produced an orthonormal transformation matrix $W_{n}$ each paradigm
that allow a mapping of data from a test subject's voxel space into the
\ac{cfs}.
%
To investigate how the amount of data used to acquire a transformation matrix
affects estimation performance, we also varied the number of runs per paradigm.
%
Specifically, we we used one up to four runs (each lasting \unit[5.2]{min}) of the
visual localizer, and one up to eight segments (each lasting
$\approx$\unit[15]{min}) to align the test subject to the corresponding \acp{tr}
within the \ac{cfs}.
%
Therefore, for each test subject, we obtained four matrices based on data from
the visual localizer and eight different matrices per naturalistic stimulus,
each transformation matrix having a size of $v$ voxels by $k$ shared responses
but being based on an increasing amount of data used to calculate the mapping.


\subsubsection{Estimation of $t$-contrasts' results}

% overview
We estimated the results of the three $t$-contrast (i.e. the \textit{empirical
$Z$-maps}) of the test subject by projecting the empirical $Z$-maps of all
training subjects trough the \ac{cfs} into the test subject's voxel space:
% functional alignment; into CFS (calling srm.transform(masked\_zmaps))
First, we masked the empirical $Z$-maps of the training subjects' empirical
$Z$-maps with the same subject-specific masks used to generate the \ac{cfs} from
the time series data.
%
Then,  we used the transformation matrices derived during the training of the
\ac{cfs} to map the masked empirical $Z$-maps from each training subject's voxel
space into the \ac{cfs}.
%
Next, we used the transpose of a transformation matrix obtained from the
alignment of the test subject to project the $Z$-maps from the \ac{cfs} into the
test subject's voxel space.
% take the mean
For each of the three $t$-contrasts, we computed the arithmetic mean of the
respective projected $Z$-maps, which served as an estimation of the test
subject's empirical $Z$-maps (hence, a \textit{predicted $Z$-maps}).

\subsection{Estimation via anatomical alignment}

\todo[inline]{strictly speaking data were not projected through the MNI152 atlas
but through a study-specific brain template co-registered to the MNI152 atlas,
wasn't it?}

\todo[inline]{here is a point where one could switch from "transformation
matrices" back to simply "transformations".}

\todo[inline]{was the matrix the transpose or a "totally" different one?}

%
As a baseline, we used an anatomical alignment procedure to estimate the results
of $t$-contrast of each paradigm.
%
We predicted a test subject's empirical $Z$-maps from the analysis of
%
the visual localizer \citep{sengupta2016extension},
%
the movie \citep{haeusler2022processing}, and
%
the audio-description \citep{haeusler2022processing}
%
using the training subjects' results of the same paradigm (hence,
cross-subject-within-paradigm predictions).
%
To do this, we projected the masked empirical $Z$-maps of each paradigm and each
subject were projected from their native voxel space into the MNI space via
previously computed subject-specific transformation matrices
\citep[][\href{https://github.com/psychoinformatics-de/studyforrest-data-templatetransforms}{\url{github.com/psychoinformatics-de/studyforrest-data-templatetransforms}}]{hanke2014audiomovie}.
% from MNI into subject
We then used the transpose of the transformation matrix to project the data from
the MNI space into the test subject's voxel space.
% take the mean
Similar to our functional alignment procedure, we obtained an estimation of the
test subject's empirical $Z$-maps by taking the arithmetic mean of the projected
$Z$-maps.



\subsection{Cronbach's alpha}

\todo[inline]{I have no clue where \citet{jiahui2020predicting, jiahui2022cross}
have the statement about what Cronbach's expresses from...}

\todo[inline]{shift results stated here to actual result section? In particular,
in case a t-test involving Cronbach's is calculated (which is not the case so
far)?}



%
We calculated Cronbach's $\alpha$ as a measure of reliability and the amount of
measurement error \citep{cronbach1951coefficient, cortina1993coefficient}
present in the empirical $Z$-maps of each paradigm and subject.
%
Cronbach's $\alpha$ expresses the expected correlation between the currently
used empirical $Z$-maps and an additional set of empirical $Z$-maps calculated
based on data of a hypothetical independent dataset collected from the same
paradigm and subjects \citep{jiahui2020predicting, jiahui2022cross}.
%
These expected correlations, represented by Cronbach's $\alpha$, were calculated
based on the first-level \ac{glm} $Z$-maps (four in case of the visual
localizer; eight in case of the naturalistic stimuli) that were averaged in the
second-level \ac{glm} analyses of \citet{sengupta2016extension} and
\citet{haeusler2022processing} respectively.
%
Cronbach's $\alpha$ of empirical (i.e. second-level) $Z$-maps for each subject
and paradigm can be seen in Fig.~\ref{fig:cronbachs}, descriptive statistics
across subjects for each paradigm can be seen in Table~\ref{fig:cronbachs}.

% The Cronbach's $\alpha$ values for each paradigm are as follows:
% For the visual localizer, the mean is 0.899990 with a standard deviation of
% 0.087051. The minimum value is 0.658523, the 25th percentile is 0.906643, the
% median is 0.934019, the 75th percentile is 0.947906, and the maximum is
% 0.963065.

% For the movie paradigm, the mean is 0.611332 with a standard deviation of
% 0.137878. The minimum value is 0.284440, the 25th percentile is 0.555529, the
% median is 0.627240, the 75th percentile is 0.676353, and the maximum is
% 0.800254.
% movie's outlier: sub-06 (0.28); but when movie PPA is predicted he / she is
% not the outlier

% For the audio-description paradigm, the mean is 0.476194 with a
% standard deviation of 0.358019. The minimum value is -0.526626, the 25th
% percentile is 0.428975, the median is 0.627799, the 75th percentile is
% 0.679987, and the maximum is 0.823584.
% audio-description's outlier: sub-05 (-0.5!), sub-02 (0.0), sub-20 (0.27);
% when audio PPA is predicted, these three subjects are the outliers


\begin{figure*}[tbp] \centering
    \includegraphics[width=\linewidth]{figures/plot_cronbachs.pdf}
    \caption{\textbf{Cronbach's $\alpha$ of the empirical $Z$-maps for each
    paradigm and subject.}
    %
    Cronbach's $\alpha$ was calculated based on the $Z$-maps yielded by the
    first-level \ac{glm} analyses of the visual localizer
    \citep[four runs;][]{sengupta2016extension} and naturalistic stimuli
    \citep[eight segments;][]{haeusler2022processing}.
    %
    The second-level \ac{glm} analyses across runs / segments yielded the
    empirical $Z$-maps that were estimated in the present study.
    }
    \label{fig:cronbachs}
\end{figure*}


\begin{table*}[btp]
\centering
    \caption{
    %
    \textbf{Descriptive statistics of Cronbach's $\alpha$ across subjects.}
    %
    Cronbach's $\alpha$ of the empirical $Z$-maps that are the result of the
    second-level \ac{glm} analyses performed in
    \citet{sengupta2016extension} and \citet{haeusler2022processing}. Values of
    Cronbach's $\alpha$ were calculated based on the first-level $Z$-maps (four
    in case of the visual localizer; eight in case of the naturalistic stimuli)}
\label{tab:cronbachs}
\begin{tabular}{llll}
    \toprule
    \textbf{statistic} & \textbf{localizer} & \textbf{movie} & \textbf{audio-description} \\
    \midrule
    mean & 0.90 & 0.61 & 0.48 \tabularnewline
    std & 0.09 & 0.14 & 0.36 \tabularnewline
    min & 0.66 & 0.28 & -0.53 \tabularnewline
    25\% & 0.91 & 0.56 & 0.43 \tabularnewline
    50\% & 0.93 & 0.63 & 0.63 \tabularnewline
    75\% & 0.95 & 0.68 & 0.68 \tabularnewline
    max & 0.96 & 0.80 & 0.82 \tabularnewline
    \bottomrule
\end{tabular}
     % \caption*{The legend text goes here.}
\end{table*}



\section{Results}


\begin{comment}

``Because the localizer task comprises several scanning runs, we calculated the
reliability of the localizer across runs with Cronbach's $\alpha$ to provide an
estimate of the noise ceiling for these correlations'' \citep{jiahui2022cross}.

\end{comment}


The unthresholded $Z$-maps in their respective subject's voxel space can be
accessed at
\href{https://identifiers.org/neurovault.collection:12340}{\url{neurovault.org/collections/12340}}.
\todo{still empty}
%
We calculated the correlation between each individual's empirical $Z$-maps
obtained from previous analyses \citep{haeusler2022processing,
sengupta2016extension} and their respective predicted $Z$-maps (cf.
Fig.~\ref{fig:stripplot}) to assess the performance of the alignment procedures.
%
In general, the mean Pearson correlation coefficients vary depending on the
criterion being estimated (i.e. $Z$-maps of the visual localizer, movie, or
audio-description), as well as the functional alignment procedure (anatomical
vs. functional alignment).
%
In the case of functional alignment, the quantity of the paradigm's data used as
a predictor and to align a test subject to the \ac{cfs} also affects the
correlation coefficients, as shown in Fig.~\ref{fig:stripplot}.
%
However, the functional alignment procedure consistently shows an increasing
estimation performance across criteria as more data of a predictor is used to
align the test subjects.
%
In order to investigate potential differences between some conditions, we
conducted 15 pairwise comparisons using Fisher z-transformed correlation values.
%
These comparisons were not pre-planned, but rather were selected later as
examples for further exploration.
%
We used a Bonferroni correction for multiple comparisons to adjust the alpha
level to an $\alpha$ of $0.05 / 15 = 0.00\overline{3}$.

\begin{figure*}[tbp] \centering
    \includegraphics[width=\linewidth]{figures/plot_corr-emp-vs-estimation.pdf}
    \caption{
    %
    \textbf{Correlations between empirical and predicted
    \textit{\textbf{Z}}-maps for each subject and paradigm.}
    %
    Functional alignment was performed based on an increasing amount of
    functional data used to align a test subject to the common functional space
    (CFS): each of the four runs of the visual localizer paradigm lasted
    $\approx$\unit[5]{min};
    segments of the naturalistic stimuli lasted $\approx$\unit[15]{min}.
    %
    Solid horizontal lines:
    %
    median of Cronbach's $\alpha$ across subjects for empirical $Z$-maps of the
    respectively estimated paradigm (cf. Fig.~\ref{fig:cronbachs}).
    %
    Dotted horizontal lines:
    %
    mean of Cronbach's $\alpha$ across subjects for empirical $Z$-maps of the
    respectively estimated paradigm (cf. Fig.~\ref{fig:cronbachs}).
    %
    Grey dots:
    %
    correlations between empirical $Z$-maps and an estimation using anatomical
    alignment.
    %
    Green dots:
    %
    correlations between empirical $Z$-map and an estimation using functional
    alignment based on transformations calculated from one up to four
    runs of the visual localizer.
    %
    Red dots:
    %
    correlations between empirical $Z$-map and an estimation using functional
    alignment based on transformations calculated from one up to eight
    segments of the movie.
    %
    Blue dots:
    %
    correlations between empirical $Z$-map and an estimation using functional
    alignment based on transformations calculated from one up to eight
    segments of the audio-description.
    }
    \label{fig:stripplot}
\end{figure*}


% localizer: localizer data
When estimating the $Z$-maps of the visual localizer, the mean correlation
between empirical $Z$-maps and $Z$-maps predicted using $\approx$\unit[15]{min}
of the visual localizer (within-paradigm prediction) was significantly higher
than the mean correlation between empirical $Z$-maps and $Z$-maps predicted via
anatomical alignment ($t(14)=13.99$, $p<.0001$).
% localizer: movie data
Similarly, the mean correlation between empirical $Z$-maps and $Z$-maps
predicted using $\approx$\unit[15]{min} of the movie (cross-paradigm prediction)
was significantly higher than the correlations between empirical $Z$-maps and
$Z$-maps predicted via anatomical alignment ($t(14)=6.35$, $p<.0001$).
%
A comparison between the prediction based on $\approx$\unit[15]{min} of the
movie and $\approx$\unit[15]{min} of localizer data revealed a significantly
lower performance of functional alignment using the movie ($t(14)=-11.64$,
$p<.0001$).
%
The prediction performance based on $\approx$\unit[30]{min} of the movie was
significantly higher than the prediction performance based on
$\approx$\unit[15]{min} of the movie ($t(14)=5.49$, $p=.0001$), with no
significant difference between $\approx$\unit[45]{min} and
$\approx$\unit[30]{min} of the movie ($t(14)=0.13$, $p=.8990$).
% localizer: audio data
Visual inspection indicated that the prediction performance based on
$\approx$\unit[15]{min} of the audio-description was lower than the prediction
performance based on anatomical alignment, functional alignment using
$\approx$\unit[15]{min} of the localizer, or $\approx$\unit[15]{min} of the
movie.
%
However, the prediction performance of the audio-description increased
monotonically the more data were used to align the test subjects.
%
A $t$-test comparing the prediction performance based on
$\approx$\unit[120]{min} of the audio-description to anatomical alignment
yielded no significant difference ($t(14)=-1.17$, $p=.2640$).

%
When estimating the $Z$-maps of the movie, the mean correlation between
empirical $Z$-maps and predicted $Z$-maps using $\approx$\unit[15]{min} of the
movie (within-paradigm prediction) were significantly higher than the
correlations between empirical $Z$-maps and predicted $Z$-maps via anatomical
alignment ($t(14)= 5.78$, $p<.0001$).
%
Comparing the within-paradigm prediction using $\approx$\unit[15]{min} of the
movie to the cross-paradigm prediction using $\approx$\unit[15]{min} of the
localizer revealed a higher prediction performance when using the movie data for
alignment ($t(14)=5.53$, $p<.0001$).
%
There was no significant difference between the prediction using
$\approx$\unit[15]{min} of the localizer and the prediction via anatomical
alignment ($t(14)=1.15$, $p=.2726$).
%
The prediction performance based on $\approx$\unit[30]{min} of movie data was
significantly higher than the prediction performance based on
$\approx$\unit[15]{min} of the movie ($t(14)= 3.75$, $p=.0024$), whereas there
was no significant difference between the performance based on
$\approx$\unit[45]{min} and $\approx$\unit[30]{min} of the movie ($t(14)=2.58$,
$p=.0230$).
%
As is evident by visual inspection, the prediction performance based on
$\approx$\unit[15]{min} of the audio-description was lower than a prediction
based on anatomical alignment, functional alignment using
$\approx$\unit[15]{min} of the localizer, or functional alignment using
$\approx$\unit[15]{min} of the movie.
%
Here again, the prediction performance of the audio-description monotonically
increased the more data were used to align the test subjects.
%
A $t$-test comparing the prediction performance based on
$\approx$\unit[120]{min} of the audio-description to a prediction via anatomical
alignment yielded no significant difference ($t(14)=-2.40$, $p=.0318$).

%
When estimating the $Z$-maps of the audio-description, the mean correlation
between empirical $Z$-maps and predicted $Z$-maps via $\approx$\unit[15]{min} of
the audio-description (within-paradigm prediction) was not significantly
different to the mean correlation between empirical $Z$-maps and predicted
$Z$-maps via anatomical alignment ($t(14)=-1.82$, $p=.0925$).
%
Comparing the prediction based on $\approx$\unit[120]{min} of the
audio-description to the anatomical alignment procedure yielded a significantly
higher performance of the estimation via functional alignment ($t(14)=6.56$,
$p<=.0001$).
%
Comparing the prediction based on functional alignment via
$\approx$\unit[120]{min} of the movie to the anatomical alignment procedure
yielded no significant difference ($t(14)=-0.76$, $p=.4625$).





\pagebreak


\section{Discussion}

\todo[inline]{Delete captions of subsubsections}

\subsection{Introductory paragraph}

%
We investigated the performance of a functional alignment procedure that we used
to predict results of $t$-contrasts (i.e. the criteria) that were created in
previous studies \citep{sengupta2016extension, haeusler2022processing} in order
to localize the \ac{ppa}.
%
Following a leave-one-subject-out cross-validation, we fit a shared response
model \citep{chen2015reduced} to the training subjects' concatenated response
time series of three different paradigms in order to create a multi-paradigm
\ac{cfs} and the training subjects' subject-specific transformations.
%
\todo{add what they are good for}
%
In order to acquire the test subject's transformation, we used an
increasing amount of the test subject's response time series of the three
paradigms (i.e. the predictors)  separately by functionally aligning the test
subject to the corresponding \acp{tr} of the shared feature space (i.e.
\ac{cfs}).
%
The empirical $Z$-maps of each training subject were projected from their
respective voxel space through the \ac{cfs} into the test subject's voxel space
to yield the test subject's predicted $Z$-maps.
%
In case of the anatomical alignment approach that served as a baseline, the
training subjects' $Z$-maps were projected via nonlinear, volume-based
transformation through the MNI152 brain atlas into the test subject's voxel
space.


\subsubsection{Four aspects under investigation}

\todo[inline]{this needs to be in line with paragraph "In contrast to previous
studies..." in intro}

\todo[inline]{biggest issue: how to separate validity / generalizability of
\ac{cfs} from validity / generalizability of transformations}

\todo[inline]{in any case: within-paradigm prediction is more about validity of
model? cross-paradigm prediction is more generalizability of transformations?}
%
First, we assess the \textbf{validity of the \ac{cfs}} by estimating $Z$-maps
from the analysis (i.e. $t$-contrast) of same paradigms used to align the test
subject (cross-subject-\textbf{within-paradigm} prediction).
%
Second, we assess the \textbf{generalizability of the transformations}
by estimating $Z$-maps from the analysis (i.e. $t$-contrast) of paradigms that
were not used to align the test subject (cross-subject-\textbf{cross-paradigm}
prediction).
%
Third, we explore the relationship between the estimation performance of the
t-contrast's results and the quantity of data from each of the three paradigms
used to functionally align the subject with the \ac{cfs}.
%
Last, we compared the performance of our volume-based, functional alignment
procedures to that of a volume-based, anatomical alignment approach, which
served as a benchmark.


\subsubsection{Results + Conclusion}
%
We found that using a partial alignment approach with a multi-paradigm \ac{cfs}
derived from concatenated time series of multiple paradigms is effective.
%
The prediction performance improves as more data from the paradigms used to
align a test subject included.
%
However, one movie segment outperformed an estimation using anatomical
alignment.
%
This opens up the possibility of estimating results from many localizer
paradigms using a naturalistic stimulus of similar duration of one traditional
localizer paradigm.



\subsection{Anatomical alignment vs. functional alignment}

\todo[inline]{it is actually not that bad}

\todo[inline]{it's consistent across paradigms, too (always a median correlation
of about 0.6)}

%
When estimating the visual paradigms (localizer and movie PPA), using just one
movie segment with partial alignment outperformed anatomical alignment.
%
When estimating audio PPA, as more movie data were included, the prediction
performance of the multi-paradigm CFS improved the more data of the movie are
included, and eventually became as good as anatomical alignment
%
However, using just one movie segment resulted in worse performance than
anatomical alignment.

%
In contrast, localizer runs were not effective for estimating the localizer
$Z$-maps for within-paradigm prediction and movie PPA for cross-paradigm
prediction compared to anatomical alignment.
%
Surprisingly, when estimating audio PPA (cross-paradigm), the localizer for
alignment came close to anatomical alignment, indicating that audio PPA is the
criterion that the visual localizer can estimate the best.


The performance of audio-description is inferior to anatomical alignment for
cross-paradigm estimation.
%
However, it improves when more segments are used for alignment.
%
In cross-paradigm prediction, the gap between movie and audio-description
narrows as more data of the audio-description is used.
%
In within-paradigm prediction, audio-description eventually outperforms
anatomical alignment when more than 4-6 segments are used.
%
Nevertheless, for every alignment procedure (both functional and anatomical), it
is difficult to estimate the outliers of Cronbach's $\alpha$ of audio PPA.



\subsection{Functional alignment}




\subsubsection{Movie for functional alignment}

\todo[inline]{a.k.a. movie is best (which is in line with previous research)}

\todo[inline]{paragraph focuses on estimation of localizer though}

%
When estimating the visual localizer, results indicate that $\approx$$\approx$\unit[15]{min}utes
(\ac{tr}=2s) of movie watching used for functional alignment outperform
prediction using anatomical alignment.
%
Prediction performance further increases when $\approx$$\approx$\unit[30]{min}utes of movie data
submitted to the algorithm to calculate the subject-specific transformations.
%
However, three segments ($\approx$45 minutes) do not lead to an significantly
increased estimation performance suggesting a decreasing benefit of longer
scanning time than $\approx$\unit[30]{min}utes during audio-visual naturalistic stimulation.



\subsubsection{Visual localizer for functional alignment}

\todo[inline]{a.k.a. why is it bad? which is not in line with previous research}

\todo[inline]{is it our model or the transformation matrices?}

%
Unexpectedly, the prediction of the localizer using localizer runs (i.e.,
within-experiment prediction) was worse than anatomical alignment.
%
It is possible that our naturalistic stimuli (about 7000 TRs) may have
"disrupted" our shared responses during the 450 \acp{tr} within the SRM?
%
However, the correlations of regressors with shared responses (cf.
Fig.~\ref{fig:corr-vis-reg-srm}) indicate that the shared responses show the
highest correlation with regressors of the localizer.
%
Therefore, the matrices based on the localizer runs are less reliable for
estimation compared to anatomical alignment?



\subsubsection{Audio-description for functional alignment}

\todo[inline]{a.k.a. it's totally different from different previous research}

%
Using the audio-description for functional alignment to estimate visual
paradigms/cross-modal by using data from a non-visual paradigm is a challenging
task.
%
However, the estimation performance increases with the availability of
more data.
%
One possible explanation could be that the audio-description lacks visual
stimulation and is not as rich as the movie.
%
Another explanation is that the response in the PPA to a auditory paradigm is
(too) different from a response in the PPA to a visual paradigm.
%
Nevertheless, the data collected during listening to an audio-description, which
is richer than a mere narrative, could potentially be used to estimate a visual
category-selective area. However, the current approach requires impractical
amounts of data.
%
It would be interesting to estimate the results from a controlled speech
paradigm, i.e., another same-modality criterion.


\paragraph{audio PPA as criterion: the issue of reliability}

\todo[inline]{also true (but less severe) in case of movie PPA}

\todo[inline]{needs to be in line with general discussion's pros \& cons of
naturalistic stimuli}

%
When estimating audio PPA, the participants with poor Cronbach's $\alpha$ have
the lowest correlation between predicted and empirical $Z$-maps.
%
When estimating audio PPA, participants with poor Cronbach's $\alpha$ have the
lowest correlation between predicted and empirical $Z$-maps.
%
These participants are not "reliable outliers deviant from the norm" but may be
considered as unreliable outliers due to their noisy data.
%
Therefore, the SRM may be performing some level of denoising instead of modeling
these unreliable outliers incorrectly.

%
Was the construct "perception of auditory spatial information" modeled
insufficiently in \citet{haeusler2022processing}?
%
The primary audio-description contrast yielded bilateral clusters in nine
participants that overlapped with the block-design localizer results, and one
cluster in the left-hemispheric PPA for one participant (sub-09). Thus, it seems
that the construct was sufficiently modeled for more than 50\%.
%
The fact that it worked for most subjects suggests that the issue is not a
methodological decision and that the audio-description does sample the responses
to spatial information.
%
Rather, it is more likely an issue with the naturalistic paradigm, which allows
for more individual variation over the course of the two-hour long stimulation,
possibly influenced by an unbalanced number of events per stimulus segment.
%
Although the shared responses show the highest correlation with the regressors
of the visual localizer, the plots of shared responses and regressors of the
audio-description (cf. Fig.~\ref{fig:corr-ao-reg-srm}) suggest that the shared
responses during TRs of the audio-description are not entirely noise but that
the shared features during TRs of the movie and audio-description seem to be
more abstract.
%
Final point: given that the within-paradigm prediction works well for most
subjects, outliers of Cronbach's $\alpha$ do not significantly degrade the
model.

%
Perhaps the large individual variability observed in some subjects during the
audio-description paradigm is due to the paradigm itself, which allows for more
variation over the two-hour long stimulation.
%
Another possibility is that the 2-hour long auditory stimulation is not as
immersive or engaging as the multi-modal audio-visual movie.
%
A potential challenge in controlling for these factors is the difficulty in
judging or controlling attentional focus compared to eye-tracking during a
movie.
%
However, it may be possible to measure alertness using EEG recordings.
%
Alternatively, it could be related to the auditory domain in general, although
this is difficult to determine precisely and needs a dedicated paradigm, imo.


\paragraph{Just a bold inference}

\todo[inline]{add text about SRM as denoising technique?}
%
The current results suggest that the processing of auditory spatial information
is reliably engaged across subjects during the audio-description and in such a
way that the ``SRM will improve sensitivity for detecting a cognitive process of
interest in the test data'' \citep{cohen2017computational}.

%
Present results support evidence that results in \citet{haeusler2022processing}
that are restricted to the anterior part of the localizer PPA are not based on
the methodological decisions, and that the responses to auditory spatial
information lead to different activity patterns than visual stimulation.
%
Further studies using controlled paradigms are needed to investigate auditory
spatial information and studies using auditory narratives should employ more
sophisticated models of event structure in order to assess the suitability of
naturalistic stimuli as a "true naturalistic localizer".
%
It is important to note that the use of naturalistic stimuli in research can
provide more ecologically valid results, but it is also important to consider
potential confounds and limitations leading to problems we have to struggle with
here when trying to interpret the results.




\subsubsection{Interim summary (on functional alignment)}

\todo[inline]{how to separate validity \& generalizability of \ac{cfs} from
validity \& generalizability of matrices?}

\todo[inline]{if \citet{haxby2011common} is discussed (a lot), it should
probably be primed in the intro (right before "Here, we...")}

\todo[inline]{problem: \citet{feilong2022individualized} already assessed data
quantity; results suggest 30m are "good" in case of their model; plus, they
model individual component.}

%
Our results provide evidence that transformation matrices calculated based on
data from naturalistic stimuli promise an increased validity and [or?]
generalizability for functional alignment over transformation matrices based on
data of a controlled paradigm based on simplified stimuli.
%
This is the case for both within-paradigm prediction (e.g., audio-description
for alignment to estimate $Z$-maps from the audio-description's $t$-contrast)
and cross-paradigm prediction (e.g. audio-description for alignment to estimate
$Z$-maps from the visual localizer's $t$-contrast).
%
Our results are different results of \citet{haxby2011common} who found that the
prediction of $Z$-maps from a controlled paradigm via matrices \& \ac{cfs} based
on the same controlled paradigm was as good or better than prediction (of the
same) $Z$-maps via matrices \& \ac{cfs} based on movie data.
%
In summary, the multi-stimulus \ac{cfs} generalizes over paradigms to be
estimated but performance depends on the paradigm used to align the test subject
to the \ac{cfs}.



\subsection{Vision}

% A shared calibration scan across datasets could be used to transfer data
% between datasets, a procedure that is easier to accomplish than shared
% subjects across datasets \citep[cf.][an extension of the \ac{srm} for shared
% subjects across datasets]{zhang2018transfer}.

\todo[inline]{needs to be in line with general discussion's "Vision" (which
is commented out at the moment)}

\todo[inline]{Maybe, merge part here into general discussion? the part here is
not long anyway}


\subsubsection{Intro}

\todo[inline]{maybe, repeat phrasing from introduction (cf. localizer
paradigms)}

%
Our results suggest that $\approx$\unit[15]{min}utes functional scanning using an engaging
naturalistic stimulus could provide sufficient data for a \textit{calibration
scan}.
%
A standardized calibration scan could be used to align a new subject to a
\ac{cfs} that was derived from extensive scans of a reference group.
%
The reference group's scans would include data collected from both naturalistic
paradigms and controlled paradigms.
%
The controlled paradigms could include functional localizers that are
specifically designed to reliably map brain processes involved in, for example,
low-level auditory or visual perception, as well as higher cognition, such as
theory of mind or \citep{spunt2014validating} or semantic processes
\citep{fedorenko2010new, fernandez2001language}.
%
The diagnostic run would be based on a multifaceted naturalistic stimulus that
samples a broad range of brain states in order to allow for a valid alignment to
the reference \ac{cfs}.
%
Compared to a diagnostic run based on a controlled paradigm, a naturalistic
stimulus would have the additional benefits of higher engagement and better
compliance \citep{vanderwal2015inscapes, eickhoff2020towards}, especially in
children or patients.


\paragraph{Application: estimate \& quantify regular vs. deviant pattern}

%
Once a new subject is aligned to the \ac{cfs}, the functional patterns collected
in a reference group could be mapped through the \ac{cfs} into the new subject's
voxel space.
%
This would allow for the estimation of regular patterns in the new subject when
additional functional scans are not feasible due to scanner availability, time
limitations, monetary constraints, or compliance issues.
%
Moreover, this approach would allow for the quantification of the similarity (or
difference) of a new subject's actual pattern (i.e., an empirical $Z$-map) to a
pattern estimated from a healthy or clinical reference group.


\todo[inline]{essentially quoting the abstract of \citet{yates2021emergence}:}
%
For instance, a recent study by \citet{yates2021emergence} ``employed shared
response modeling to investigate the presence and localization of adult
functions in children.
%
The authors learned a feature space from fMRI activity of adults watching a
movie and then translated the shared features into the anatomical brain space of
children aged 3 to 12 years old.
%
They found reliable correlations between reconstructed activity and children's
actual fMRI activity as they watched the same movie.
%
The strength of the correlation in the precuneus, inferior frontal gyrus, and
lateral occipital cortex predicted chronological age.
%
This approach demonstrates the potential to generalize findings across different
populations and ages, further highlighting the importance of establishing a
reliable and accurate \ac{cfs}''.



\subsection{Future questions}

\todo[inline]{just some ideas...}


\subsubsection{Other ROIs than category-selective areas}

\todo[inline]{topic for general discussion: limit of naturalistic stimuli
(passively consumed)?}


\begin{comment}

\paragraph{Results of \citet{frost2012measuring}}
%
``We localized 13 widely studied functional areas and found a large variability
in the degree to which functional areas respect macro-anatomical boundaries
across the cortex.
%
The percent gain in overlap [after surface-based alignment] differed greatly
across the different functional regions throughout the cortex.
%
There is a strong structural-functional correspondence in some areas whilst in
others the spatial location of the functional area is not tightly bound to
anatomical landmarks and varies greatly across subjects within a cortical area''
\citep{frost2012measuring}.
%
Language areas were found to vary greatly across subjects whilst a high degree
of overlap was observed in sensory and motor areas.
%
PPA gained 17.6\% in the left and 27.7\% in the right hemisphere.
%
The FFA gained 44.1\% in the left and 12\% in the right hemisphere.
%
The FFA did not exhibit the same strong structural-functional correspondence and
saw more modest increases in overlap after macro-anatomical alignment.
%
FFA varies in its location along the length of the fusiform gyrus even though
the gyri themselves are well aligned across subjects.
%
LOC gained 62.7\% in the left and 38.4\% in the right hemisphere''
\citep{frost2012measuring}.

% category-specific areas
Similar to nonlinear volume-based alignment, similarity across person is higher
after surface-based alignment ``for retinotopically defined regions, with
character-selective regions showing the lowest consistency for both alignments,
closely followed by mFus- and IOG-faces'' \citep{rosenke2021probabilistic}.

\end{comment}


%
In the present study, we focused on the \ac{ppa} as a classic example of a
higher-visual area.
%
It is important to note that the alignment procedure may perform differently
when estimating other functional areas.
% varying \textit{functional--anatomical correspondence}
Previous studies have shown that there is a varying degree of correspondence
between a brain function and its underlying anatomical location.
%
Previous studies that used either volume-based \citep{zhen2017quantifying,
zhen2015quantifying} or surface-based alignment \citep{rosenke2021probabilistic,
frost2012measuring} to estimate the location of functional areas have ``found a
large variability in the degree to which functional areas respect
macro-anatomical boundaries across the cortex'' \citep{frost2012measuring}.
%
In some areas, there is a strong structural-functional correspondence, while in
others, the spatial location of the functional area varies greatly across
subjects within a cortical area \citep{frost2012measuring}
%
For example, even within in the domain of category-selective areas, the
interindividual variability varies across functional areas
\citep{zhen2017quantifying, zhen2015quantifying, frost2012measuring}:
%
For instance, in the domain of category-selective areas, interindividual
variability varies across functional areas , with scene-selective regions
showing larger variability in spatial topography compared to face-selective
regions \citep{zhen2017quantifying, frost2012measuring}.


\paragraph{Inference}

\todo[inline]{cite a review that summarizes research the range of brain studied
using naturalistic stimuli}

%
Therefore, future studies could investigate the extent to which functional
alignment leads to an increased estimation performance compared to anatomical
alignment, especially in areas where the functional-anatomical correspondence is
known to vary across subjects.
%
Naturalistic stimuli have been used to investigate a variety of domains like XYZ
[check for, e.g., visual or auditory perception, spatial cognition; emotion;
music, speech or social perception], and possibly allow valid mapping of
functional data in all of these domains.


\todo[inline]{Paraphrase:}
%
``There are numerous other functional localizers in other perceptual and
cognitive domains, such as simple visual motion, biological motion, tonotopy,
voice perception, music perception, language, calculations, working memory, and
theory of mind.
%
Because naturalistic movies include people, human actions, conversations, social
interactions, background music etc., we predict functional alignment based on
movies also will work for localizers of functional topographies for audition,
language, and social cognition.
%
Some high-level cognitive processes, such as calculation, working memory, and
logical reasoning, may be less well sampled by movie viewing, and further work
is necessary to test whether hyperalignment based on movie-viewing data can be
used to estimate topographies for these other domains of high-level cognition.
%
Researchers may need to select or develop movies that involve more calculations
or logical inference-making to afford accurate estimation of topographies in
these domains'' \citep{jiahui2020predicting}.


\paragraph{Studyforrest dataset's other localizer t-contrasts}

\todo[inline]{it is such a low-hanging fruit; better drop it?}

For instance, the visual localizer of the studyforrest dataset also contains
contrast that aimed at localizing the \ac{ffa} and \ac{ofa} that are associated
with face perception \citep{kanwisher1997ffa, pitcher2011occipitalfacearea}, the
\ac{eba} that is associated with the perception of human bodies
\citep{downing2001bodyarea}, and the \ac{loc} that is associated with the
perception of (small) objects (like tools or toys) \citep{malach1995loc},
%
The subject-specific \acp{roi} masks for these areas that where created by
\citep{sengupta2016extension} and our analysis pipeline we used in
\citet{haeusler2022processing} provide an opportunity for future studies (e.g.,
a master's thesis or part of a PhD project) to explore the hemodynamic responses
that correlate with auditory information related to faces, body parts, or small
objects.



\subsubsection{Other functional alignment algorithms}

\todo[inline]{a big treatise on functional alignment algorithms should
definitively be avoided}


\paragraph{SRM}



The SRM algorithm used in this study has a drawback in that it only models
responses that are common across individuals, without including an individual
component.
%
Although a person's idiosyncratic responses are excluded from the shared
response model, they ``are not necessarily noise and may in fact be highly
reliable within participants'' \citep{cohen2017computational}.
%
Based on the results of this study, it appears that we estimate a regular
pattern in noisy data of a couple of participants  (i.e., we perform an
\ac{srm}-based denoising).
%
However, to predict a reliably deviant pattern, it is necessary to use a
matching CFS from a deviant reference, or preferably, a model that incorporates
a shared response, an individual component, and noise.
%
Future studies should assess the performance of various functional alignment
algorithms in estimating reliably deviant patterns, e.g. atypical topographies
of language areas.
%
Does the algorithm estimate a regular pattern, which allows for quantifying the
difference of a deviant actual pattern from a norm, or does it directly estimate
the deviant pattern from a regular reference?

\todo[inline]{if this topic is supposed to be discussed, check outsourced
templates for atypical language topographies (in clinical populations)}

\todo[inline]{at least two of \citet{feilong2022individualized, jiahui2022cross,
turek2018capturing} have modeled an individual component.}




% citep{cohen2017computational} on SRM and individual residuals
\begin{comment}

\paragraph{SRM and individual differences}
%
``SRM can be used to isolate participant-unique responses by examining the
residuals after removing shared group responses, or it can be applied
hierarchically to the residuals to identify subgroups [\citet{chen2017shared}]
'' \citep{cohen2017computational}.
%
``Recognizing that signal exists beyond the average or shared response of a
group, such studies exploit idiosyncratic but stable responses to account for
previously unexplained variance in brain function, behavioral performance and
clinical measures [e.g., Finn (2015). Functional fingerprinting (based on
connectivity)]'' \citep{cohen2017computational}.
%
``In cases where each subject's unique response is of more interest than the
shared signal, SRM can be used to factor out the shared component thereby
isolating the idiosyncratic response for each subject
[\citep{chen2015reduced}]'' \citep{kumar2020brainiak}.

\end{comment}




\subsubsection{ROI vs. whole-brain}

\todo[inline]{searchlight SRM: \citet{zhang2016searchlight}; negative:
more (hyper) parameters to vary}

``Searchlight functional alignment \citep{zhang2016searchlight,
guntupalli2016model} learns local transformations and aggregates them into a
single large-scale alignment.
%
The searchlight scheme [Kriegeskorte, 2006, Information-based...] , popular in
brain imaging \citep{guntupalli2018computational, guntupalli2016model} has been
used as a way to divide the cortex into small overlapping spheres of a field
radius.
%
This method allows researchers to remain agnostic as to the location of
functional or anatomical boundaries, such as those suggested by
parcellation-based approaches.
%
A local transform can then be learned in each sphere and the full alignment is
obtained by aggregating (e.g. summing as in \citep{guntupalli2016model} or
averaging) across overlapping transforms.
%
The aggregated transformation produced is no longer guaranteed to bear the type
of regularity (e.g orthogonality, isometry, or diffeomorphicity enforced during
the local neighborhood fit)..
%
``In the case of searchlight Procrustes, we selected searchlight parameters to
match those used in Guntupalli et al. (2016):
%
each searchlight had 5 voxel radius, with a 3 voxel distance between searchlight
centers'' \citep{bazeille2021empirical}.


\subsubsection{Volume- vs surface-based}

\todo[inline]{An "issue" for reviewers but, imo, it's not a real issues}

\todo[inline]{opportunity costs: $Z$-maps of localizer were calculated in voxel
space; we are nearer on the raw data (less error accumulation) because we work
with voxels (surface vertices need additional mapping of $Z$-maps calculated
from smoothed data); probably "difficult" to adapt to subcortical structures}

We compare volume-based anatomical alignment to volume-based functional
alignment.
%
Future work could compare surface-based alignment that respects cortical folding
structure -- that out-performs predictions based on [affine] volume-based
anatomical alignment \citep{weiner2018defining} -- to surface-based functional
alignment.


\subsubsection{Time series vs connectivity-based}

\todo[inline]{\citet{jiahui2022cross} do connectivity-based 1-step
hyperalignment across different movie datasets which is as good as response
hyperalignment; however, it's a shitty procedure to scale because it needs a
transformation matrix for every pair of subjects (i.e no \ac{cfs})}

\todo[inline]{just some templates:}

%
``Derivation of this common space can be based on either neural response
profiles (e.g. data collected during tasks, such as movie viewing (Haxby et al.,
2011)) or functional connectivity profiles files
\citep{guntupalli2018computational}.
%
Response-based hyperalignment maps data from the anatomical space to a common
information space based on time-point response patterns across cortical
vertices.
%
Connectivity-based hyperalignment maps data from the anatomical space to a
common information space based on functional connectivity patterns''
\citep{busch2021hybrid}.

%
``The number of voxels that can be considered simultaneously for functional BOLD
response time series alignment is limited by the number of timepoints in the
calibration scan (about 300-400 voxels for a 15min scan with a 2s TR,
corresponding to a local cortical neighborhood of about 1cm in diameter for a
standard resolution).
%
This limitation does not exist in this form for a functional alignment that is
based on connectivity vectors.
%
The length of these connectivity vectors is determined by the number of
reference (or seed) regions in the brain'' [project proposal].


% Kumar on Nastase's ugly mofo paper
``Estimating the SRM from functional connectivity data rather than response time
series circumvents the need for a single shared stimulus across subjects.
%
Connectivity SRM allows us to derive a single shared response space across
different stimuli with a shared connectivity profile
\citep{nastase2019leveraging}'' \citep{kumar2020brainiak}.
%
``The sampling of connectivity vector space is defined by the selection of
connectivity targets, but the richness and reliability of connectivity estimates
depends on the variety of brain states over which connectivity is estimated''
\citep{haxby2020hyperalignment}.


%
``Response-based hyperalignment was shown to align response-based data better
than connectivity-based hyperalignment, whereas connectivity-based
hyperalignment was shown to better align connectivity-based data than
response-based hyperalignment
%
Response-based common spaces better align response data, whereas
connectivity-based common spaces better align connectivity data
\citep{guntupalli2018computational}'' \citep{busch2021hybrid}.


\subsection{Short comings}

\todo[inline]{Any other short comings? Most is (or can be implicitly) mentioned in "Future Questions")}

\subsubsection{Bigger sample size}
%
The SRM is computationally less demanding [= "computationally more efficient"?]
than hyperalignment, an advantage for scientists who want to replicate our
results but do not have access to a high-performance computer cluster [or
"high-throughput computer cluster" or simply "specialized hardware"?].
%
Moreover, it should scale pretty well to bigger sample sizes; compared to, for
example, \citet{jiahui2020predicting, jiahui2022cross} 1-step hyperalignment
alignment that needs pair-wise matrices for subjects (because no CFS).


\paragraph{Small sample size lead to varying \ac{cfs} across subjects}
% "unstable" CFS
The correlations of shared responses within the \acp{cfs} created from $N-1$
training subjects varied across the folds of the cross-validation.
% interpretation
That means, a change of 1/13 of the data for every subject's analysis is causing
the estimates to vary [how much?].
% conclusion
Future studies, should create a \ac{cfs} based on data from more subjects and
investigate the relationship between number of participants, variability of
parameters, and estimation performance.


\subsection{Conclusion}

God bless America!


\section{Data Availability}

\todo[inline]{all from PPA-Paper but with new GIN link leading to an empty repo}

% \href{https://gin.g-node.org/chaeusler/studyforrest-ppa-analysis}{\url{gin.g-node.org/chaeusler/studyforrest-ppa-analysis}}

% new; PPA analysis
All fMRI data and results are available as Datalad \citep{halchenko2021datalad}
datasets, published to or linked from the \emph{G-Node GIN} repository
(\href{https://gin.g-node.org/chaeusler/studyforrest-ppa-srm}{\url{gin.g-node.org/chaeusler/studyforrest-ppa-srm}}).
% original
Raw data of the audio-description, movie and visual localizer were originally
published on the \emph{OpenfMRI} portal
(\url{https://legacy.openfmri.org/dataset/ds000113}; \citep{Hanke2014ds000113},
\space \url{https://legacy.openfmri.org/dataset/ds000113d};
\citep{hanke2016ds000113d}).
% visual localizer
Results from the localization of higher visual areas are available as Datalad
datasets at \emph{GitHub}
(\href{https://github.com/psychoinformatics-de/studyforrest-data-visualrois}{\url{github.com/psychoinformatics-de/studyforrest-data-visualrois}}).
% raw data
The realigned participant-specific time series that were used in the current
analyses were derived from the raw data releases and are available as Datalad
datasets at \emph{GitHub}
(\href{https://github.com/psychoinformatics-de/studyforrest-data-aligned}{\url{github.com/psychoinformatics-de/studyforrest-data-aligned}}).
% OpenNeuro
The same data are available in a modified and merged form on OpenNeuro at
\url{https://openneuro.org/datasets/ds000113}.
% NeuroVault for z-maps of SRM
Unthresholded $Z$-maps of all contrasts can be found at
\href{https://identifiers.org/neurovault.collection:12340}{\url{neurovault.org/collections/12340}}.


\section*{Code Availability}

Scripts to generate the results as Datalad \citep{halchenko2021datalad} datasets
are available in a \emph{G-Node GIN} repository
(\href{https://gin.g-node.org/chaeusler/studyforrest-ppa-srm}{\url{gin.g-node.org/chaeusler/studyforrest-ppa-srm}}).






\pagebreak

\section{Backup of texts regarding "done but not mentioned"}


\subsection{Calculate $Z$-maps mean in the common space already}
%
I also tested averaging $Z$-maps in the \ac{cfs} (i.e.: not in the test
subject's voxel space): similar results
%
In case of anatomical alignment, I did
not test averaging data in MNI152 space.


\subsection{Calculate $Z$-map from training subjects' TRs in FEAT}

iirc, I projected all subjects' localizer time series through
model space into test subject voxel space; then, calculated the contrast
with these data (s. scripts 'test/data\_denoise-vis.py' \&
'test/data\_srm-vis-to-ind.py').
%

The problem was: if one wants to test the different transformation matrices (I
only did it with one; imo, based on alignment using the whole audio-description)
it gets totally messy \& computational intensive.
%
Results were similar to the original procedure if not slightly worse.


\subsection{Leakage of test data in union of individual \acp{ppa}}

%
We used the union of individual \acp{ppa} as spatial constrain for $Z$-maps.
%
But we have a leakage of test data (test subject is in data for the mask).
%
We might miss some voxels (of some participants) at the borders of the \ac{roi},
because the subject-specific, binary masks are based on a ("titrated")
threshold.  \citep{sengupta2016extension}
%
In the future, an independent probabilistic atlas should be used, the \ac{roi}
dilated, [and a separate model calculated for each hemisphere].
