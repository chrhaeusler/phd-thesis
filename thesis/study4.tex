\todo[inline]{time series of vs. from?}

\todo[inline]{negative control: shuffle runs within or across paradigms?}


\section{Introduction}

% higher visual areas higher visual areas
In the domain of higher-visual perception, functionally defined
category-selective brain regions, such as the \acl{ppa} (PPA)
\citep{epstein1998ppa}, the \acl{ffa} (FFA) \citep{kanwisher1997ffa},
or the \ac{eba} \citep{downing2001bodyarea} exhibit significantly increased
\acf{bold} activity correlated with a ``preferred'' \citep[][p.
123]{debeck2008interpreting} stimulus class.
%
While the topographies (i.e. the location, size and shape) of these
category-selective areas are similarly distributed across individuals, the exact
topographies vary interindividually \citep{rosenke2021probabilistic,
zhen2017quantifying, zhen2015quantifying, frost2012measuring}.
% definition of localizer
To identify the topography of functional areas in individual persons,
block-design \textit{functional localizer} paradigms are traditionally used that
contrast modeled hemodynamic responses correlating with the corresponding
stimulus classes, such as landscapes, faces, or bodies.
% problem: one localizer for one domain
Functional localizers are designed to maximize detection power and thus limited
to mapping only one domain of brain functions, such as category-selective
regions \citep{stigliani2015temporal}, retinotopic visual areas
\citep{wang2015probabilistic}, theory of mind \citep{spunt2014validating}, or
semantic processes \citep{fedorenko2010new, fernandez2001language}.
% which gets messy
However, when mapping multiple functional domains in a limited amount of time is
desired, the "one paradigm for one domain of functions" approach becomes
impractical.
% localizer batteries: intro
To address this issue, researchers have attempted to create time-efficient,
multi-functional \textit{localizer batteries} \citep[e.g.,][]{barch2013function,
drobyshevsky2006rapid, pinel2007fast}.
% task based = shit
Nevertheless, the diagnostic quality of localizer paradigms heavily depends on a
participant's comprehension of the task instructions and general compliance, a
criteria that can be difficult to meet in clinical or pediatric populations
\citep{eickhoff2020towards, vanderwal2019movies}.

% ppa via audio-description Results also suggest that a naturally engaging,
% purely auditory paradigm like an audio-description could, in principle,
% substitute a visual localizer as a diagnostic procedure to assess brain
% functions in visually impaired % individuals \citep{haeusler2022processing}.
In a previous study \citep{haeusler2022processing}, we demonstrated that a
functionally defined region such as the \ac{ppa} can be localized using  a
\acf{glm} that is based on the annotated temporal structure of a two-hour long
naturalistic stimulus.
% full feature film is too long
However, conducting a two-hour long \ac{bold} \ac{fmri} scan session may not be
desirable or feasible due to potential compliance issues or constraints on time
and resources.
% hence, predict from reference
An alternative approach that addresses the challenges of a lengthy scanning
procedure is to localize a functional area in an individual by leveraging data
collected from an independent sample of other individuals (i.e.  from a
\textit{reference group}).
% intro: estimation via common anatomical space
Previous studies have estimated the most probable location of a functional area
in an individual from a reference group by performing either a volume-based
\citep{zhen2017quantifying, zhen2015quantifying} or a surface-based
\citep{frost2012measuring, weiner2018defining, rosenke2021probabilistic,
wang2015probabilistic} \textit{anatomical alignment}.
%
First, in order to address the issue of anatomical variability across persons,
functional data of persons in the reference group are anatomically aligned to
(i.e.  projected into) a \acfi{cas}, such as the Montreal Neurological Institute
brain atlas \citep[MNI152 atlas;][]{fonov2011unbiased}.
% project into test subject to estimate
Then, data are projected from the \ac{cas} into\todo{?} the individual person's
brain anatomy to provide an estimate of a functional region's location.
% volume-based alignment in one sentence
Volume-based anatomical alignment \citep[s.][for a review]{klein2009evaluation}
aligns voxels to a three-dimensional \ac{cas} \citep[e.g., MNI152
atlas;][]{fonov2011unbiased}.
% surface-based alignment in one sentence
Surface-based anatomical alignment \citep{fischl1999cortical, yeo2009spherical}
aligns vertices to a two-dimensional \ac{cas} \citep[e.g., FreeSurfer's
fsaverage template;][]{fischl1999high}.
% difference in one sentence
Whereas volume-based alignment does not account for individual sulcal and gyral
folding patterns, surface-based alignment respects interindividual variability
of the cortical surface.
% surface-based estimation works better
Consequently, previous studies that compared volume-based and surface-based
alignment to estimate the location of functional regions have shown that
surface-based alignment reduces inter-subject variability and improves
estimation performance \citep{rosenke2021probabilistic, frost2012measuring,
wang2015probabilistic, weiner2018defining}.
% remaining variability after surface-based alignment
However, even after surface-based alignment, the anatomical location of
functional regions varies between individuals \citep{coalson2018impact,
benson2014correction, natu2021sulcal, wang2015probabilistic, frost2012measuring,
langers2014assessment, weiner2014mid, rosenke2021probabilistic}.
% frost as an example
\citet{frost2012measuring}, for example, localized 13 functional areas of the
high-level visual cortex and ``found a large variability in the degree to which
functional areas respect macro-anatomical boundaries'' \citep[][p.
1369]{frost2012measuring}.
% functional--anatomical correspondence
The remaining variability indicates that functional areas a not necessarily
bound to anatomical landmarks, and reflects the degree of
\textit{functional--anatomical correspondence} between a brain function and its
underlying anatomical location.

% case of PPA cf. also \citet{frost2012measuring, rosenke2021probabilistic}
% \citet{weiner2018defining} showed ``that cortical folding patterns and
% probabilistic predictions reliably identify place-selective voxels in medial
% VTC across individuals and experiments''.
%
% However, ``this structural-functional coupling is not always perfect and there
% is inter-subject variability as to how much the place-selective voxels extend
% within the parahippocampal gyrus, as well as the lingual gyrus and medial
% aspects of the fusiform gyrus.
%
% Despite this inter-subject variability, place-selective voxels are always
%located within the collateral sulcus across participants.''
%\citep{weiner2018defining}.
In order to address the issue of functional-anatomical variability across
subjects, \textit{functional alignment} algorithms, such as
\textit{hyperalignment} \citep{haxby2011common, guntupalli2016model} or the
\acfi{srm} \citep{chen2015reduced, zhang2016searchlight}, have been developed.
%
Whereas anatomical alignment aligns voxels (or vertices) that share the same
anatomical location to a \ac{cas}, functional alignment aligns voxels (or
vertices) that share similar functional properties to a \acfi{cfs}.
%
Functional alignment algorithms are typically used to compute both a
high-dimensional, functional brain template (i.e. the \ac{cfs}) and
subject-specific transformations based on functional data of a study's
participants.
%
A subject-specific transformation allows to project functional data from a
subject's three-dimensional voxel space into\todo{?} the \ac{cfs}.
%
Conversely, the inverse transformation allows to project data from the \ac{cfs}
into the subject's voxel space \citep{haxby2020hyperalignment,
kumar2020brainiak}.
%
The \ac{cfs} and transformations are computed (i.e. \textit{trained}) by either
maximizing the inter-subject similarity of \ac{bold} response time series
correlating with a time-locked external stimulation \citep{haxby2011common,
chen2015reduced, sabuncu2010function}, or by maximizing the inter-subject
similarity of connectivity profiles \citep{feilong2018reliable,
guntupalli2018computational, nastase2019leveraging}.
%
While connectivity-based functional alignment has been shown to be more
effective in aligning connectivity profiles, response-based functional alignment
is more effective in aligning response time-series
\citep{guntupalli2018computational}.
%
Although functional alignment algorithms can be applied to \ac{fmri} time series
data from paradigms employing simplified stimuli, data from naturalistic stimuli
provide
%
improved generalizability of the \ac{cfs}
%
and transformations
%
to novel stimuli or tasks.
%
This is presumably because naturalistic stimuli sample a broader range of brain
states \citep{haxby2011common, guntupalli2016model}.

Consequently, a more recent procedure \citep[e.g.,][]{jiahui2020predicting,
guntupalli2016model, haxby2011common} to estimate the most probable location of
a functional area in an individual from a reference performs a functional
alignment.
% solve functional-anatomical variability
First, the functional data of individuals in the reference group are
anatomically aligned to a \ac{cas}.
%
Second, to address the issue of functional-anatomical variability across
individuals, the data are functionally aligned with (i.e. projected into) a
\ac{cfs}.
%
Finally, data are projected from the \ac{cfs} into the\todo{?} individual's
brain anatomy, serving as an estimate of a functional region's location.
% Example: Jiahui (2020)
For instance, \citet{jiahui2020predicting} used surface-based hyperalignment to
calculate \acp{cfs} and transformations based on data from
%
the movie ``Grand Budapest Hotel'' ($\approx$\unit[50]{min};
\ac{tr}=\unit[1]{s}) and
%
the movie ``Forrest Gump'' ($\approx$\unit[120]{min}; \ac{tr}=\unit[2]{s}).
%
\citet{jiahui2020predicting} then estimated $t$-contrast maps of a visual
localizer that aimed at identifying the \ac{ffa} by projecting the $t$-contrast
maps from a reference group through each \ac{cfs} into an individual's brain
anatomy.
%
Results showed that $t$-contrast maps of the visual localizer correlated more
highly with contrast maps that were estimated via hyperalignment than contrast
maps that were estimated via surface-based anatomical alignment.

% An orthonormal matrix and a matrix with orthonormal columns are closely
% related concepts, but there is a difference between the two:

% Orthonormal Matrix: An orthonormal matrix is a square matrix in which all its
% columns and rows are orthogonal to each other and have a length of 1. In other
% words, the dot product of any two distinct columns (or rows) of an orthonormal
% matrix is 0, and the length (norm) of each column (or row) is 1. Additionally,
% the transpose of an orthonormal matrix is equal to its inverse.

% Matrix with Orthonormal Columns: A matrix with orthonormal columns refers to a
% rectangular matrix in which the columns are pairwise orthogonal and have a
% length of 1. The matrix may have more columns than rows, meaning it is not
% necessarily a square matrix. The dot product of any two distinct columns is 0,
% and the length of each column is 1.

% The dot product of an orthonormal column vector with itself is always 1. This
% is because an orthonormal column vector has a length (norm) of 1, and the dot
% product of a vector with itself is equal to the square of its length.
% Mathematically, if v is an orthonormal column vector, then:
% v · v = ||v||^2 = 1^2 = 1
% Therefore, the dot product of an orthonormal column vector with itself is
% equal to 1.

% In summary, the main distinction lies in the shape of the matrix. An
% orthonormal matrix must be square, with both rows and columns being
% orthonormal, while a matrix with orthonormal columns can be rectangular, with
% only the columns satisfying the orthonormality condition.

% A matrix with orthonormal columns is not necessarily a square matrix.
% A matrix with orthonormal columns is called a column-orthonormal matrix or a
% matrix with orthonormal column vectors. This means that the columns of the
% matrix are unit vectors (vectors with a magnitude of 1) and they are
% orthogonal to each other (the dot product between any two columns is zero).
% Such a matrix can have any number of rows and columns. It can be a rectangular
% matrix, where the number of rows is not necessarily equal to the number of
% columns. The columns may still be orthonormal even if the matrix is not
% square.

% An orthonormal matrix is necessarily a square matrix. In order for a matrix to
% be orthonormal, it must have the same number of rows and columns. This is
% because the conditions for orthonormality involve the dot product between
% columns, which can only be computed when the matrices have the same number of
% elements in each column.
% So, by definition, an orthonormal matrix is always square, meaning it has an
% equal number of rows and columns.

% focus: ppa
Here again, our focus is on the \ac{ppa} \citep[e.g.,][for
reviews]{epstein2014neural, aminoff2013role}.
%
We investigated whether we can estimate the results of $t$-contrasts (i.e.
statistical $Z$-maps) serving as the \textit{criteria} to be predicted.
%
The $t$-contrasts were created in previous studies that aimed at identifying the
\ac{ppa} using response time series from three different paradigms:
%
(a) a classic visual localizer \citep{sengupta2016extension} as the assumed
``gold standard'' to localize the \ac{ppa},
%
(b) a movie \citep{haeusler2022processing}, and
%
(c) an auditory narrative \citep{haeusler2022processing}.
%
To estimate these three criteria, we employed a volume-based functional
alignment approach that utilizes the \ac{srm} \citep{chen2015reduced,
richard2019fast}.
% as implemented in the open-source software package BrainIAK \citep[Brain
% Imaging Analysis Kit;
% \href{https://brainiak.org}{\url{brainiak.org}};][]{kumar2020brainiak,
% kumar2020brainiaktutorial}.  general overview of SRM
The \ac{srm} is an unsupervised probabilistic latent-factor model that
decomposes response time series of participants who have experienced the same
stimulus into a \ac{cfs} of \textit{shared features} \citep[also known as
\textit{shared feature space};][]{chen2015reduced} and subject-specific linear
transformations.
% math stuff
Specifically, the \ac{srm} algorithm uses each $n^{th}$ subject's response time
series represented as matrix $X_{n}$ ({$v$} voxels by $t$ time points) to
compute the \ac{cfs} $C$ ($k$ shared responses by $t$ time points) and
subject-specific transformation matrices $W_{n}$ ($v$ voxels by $k$ shared
responses) with orthonormal columns ($W_{n}^{T}W_{n}=I_{k}$).
% iteratively fitted
The algorithm randomly initializes and fits the transformation matrices over
iterations to minimize the error in explaining the participants' data, while
also learning the time course of the shared responses (cf.
\href{https://brainiak.org/tutorials/11-SRM/}{\url{brainiak.org/tutorials/11-SRM}}).
% number of dimensions
Unlike hyperalignment, the number of dimensions of the \ac{cfs} is not set by
the number of voxels, but rather it is determined by the researcher to a number
lower than the number of voxels, a procedure that also filters out noise and
reduces overfitting \citep{chen2015reduced}.
% phrase math in words
Each shared feature can be thought of as a weighted sum of many voxels across
subjects \citep{kumar2020brainiak}.
% result = alignment
A subject-specific transformation matrix represents the weight of each voxel in
a subject's voxel space on each shared feature, and allows to functionally align
subjects by projecting hemodynamic responses within the voxels into the
$k$-dimensional \ac{cfs}.

% multi-paradigm model
In contrast to previous studies \citep{jiahui2020predicting,
guntupalli2016model, haxby2011common} that calculated a \ac{cfs} based on data
from a single paradigm, we calculated a \textit{multi-paradigm \ac{cfs}} based
on data from three different paradigms.
% cross-validation
Following an exhaustive leave-one-subject-out cross-validation (N$=$14
subjects), each \textit{training subject}'s response time series from
%
the movie ``Forrest Gump'' ($\approx$\unit[120]{min}, split into eight runs;
\ac{tr}=\unit[2]{s}),
%
the movie's audio-description that was produced for a visually impaired audience
($\approx$\unit[120]{min}, split into eight runs runs; \ac{tr}=\unit[2]{s}), and
%
the visual localizer ($\approx$\unit[20]{min} split into four runs;
\ac{tr}=\unit[2]{s})
%
were concatenated and fed into the \ac{srm} algorithm in order to calculate the
\ac{cfs} and the training subjects' transformations (s.
Fig.~\ref{fig:multi-stimulus-cfs}).
% test subject's transformation
In order to investigate the prediction performance of each paradigm, we then
performed a \textit{partial alignment} of the \textit{test subject}:
%
a test subject's response time series from each of the three paradigms was
separately aligned with the paradigm's corresponding \acp{tr} within the
\ac{cfs} letting us obtain transformation matrices based on each paradigm.
%
In other words, the time series of each paradigm served as a separate
\textit{predictor} to estimate three different criteria (i.e. one
\textit{cross-subject-within-paradigm prediction} and two
\textit{cross-subject-cross-paradigm predictions} per paradigm).
%
Further, considering that acquiring functional data from a two-hour long
naturalistic stimulus to align an individual to a \ac{cfs} may not be desirable
or feasible, we also investigated the relationship between the quantity of data
of each predictor used to obtain a test subject's transformation and the
subsequent performance of estimating each criterion.

\todo[inline]{add 1-3 sentences stating the results (that en passant explain the
last sentence)}

\todo[inline]{mention: number of minutes, generalization of predictors across
criteria, and comparison to the volume-based, anatomical alignment that serves
as a benchmark)}

\todo[inline]{add 1 sentence stating a conclusion (\& vision)}

% Our results suggest that it is possible to ``scan once, estimate many''

\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/multi-stimulus-cfs.pdf}
\caption{
%
    \textbf{Overview of the shared response model (SRM).
}
    %
    For each fold of the leave-one-subject-out cross-validation, each training
    subject's response time series of
    %
    the movie ($\approx$\unit[120]{min}; \acf{tr}=\unit[2]{s}),
    %
    the movie's audio-description ($\approx$\unit[120]{min};
    \ac{tr}=\unit[2]{s}),
    %
    and the visual localizer ($\approx$\unit[20]{min}; \ac{tr}=\unit[2]{s})
    %
    were concatenated to serve as the input for the \ac{srm} algorithm.
    %
    From these response time series represented as matrix $X_{n}$ ({$v$} voxels
    by $t$ time points), the algorithm calculates the common functional
    space (CFS) $C$ ($k$ shared features by $t$ time points) and
    subject-specific transformation matrices $W_{n}$
    ($v$ voxels by $k$ shared features) with orthonormal columns
    ($W_{n}^{T}W_{n}=I_{k}$).
} \label{fig:multi-stimulus-cfs} \end{figure*}





\section{Methods}

% we get the data from the naturalistic PPA paper (its subdataset) datalad get
% -n inputs/studyforrest-ppa-analysis/inputs/studyforrest-data-aligned datalad
%  get
%  inputs/studyforrest-ppa-analysis/inputs/studyforrest-data-aligned/sub-??/in\_bold3Tp2/sub-??\_task-a?movie\_run-?\_bold*.*

% reference to PPA-Paper
For the current study, we used the same subset of the studyforrest dataset as in
\citet{haeusler2022processing}.
%
The same fourteen participants
% VIS
participated in a six-category block-design visual localizer
\citep{sengupta2016extension},
% AV
watched the audio-visual movie ``Forrest Gump'' \citep{hanke2016simultaneous},
and
% AD
listened to the movie's audio-description \citep{hanke2014audiomovie}.
% see corresponding papers for details
An exhaustive description of the participants, stimulus creation, procedure,
stimulation setup, and fMRI acquisition can be found in the corresponding
publications, while a summary is provided in \citet{haeusler2022processing}.



\subsection{Preprocessing}

% data sources
The analyses in this study were conducted on the same preprocessed \ac{fmri}
data (s.
\href{https://github.com/psychoinformatics-de/studyforrest-data-aligned
}{\url{github.com/psychoinformatics-de/studyforrest-data-aligned}}) that were
used for
%
(a) the technical validation of the dataset \citep{hanke2016simultaneous},
%
(b) the localization of higher-visual areas \citep{sengupta2016extension}, and
%
(c) the investigation of responses of the \ac{ppa} correlating with naturalistic
spatial information \citep{haeusler2022processing}.
%
We reran the preprocessing and analyses steps performed in
\citet{sengupta2016extension} and \citet{haeusler2022processing} using FEAT
v6.00 \citep[FMRI Expert Analysis Tool;][]{woolrich2001autocorr} as shipped with
FSL v5.0.9 \citep[\href{https://www.fmrib.ox.ac.uk/fsl}{FMRIB's Software
Library;}][]{smith2004fsl} to reproduce the time series that served as input for
the previous statistical analyses and their results (i.e. the $Z$-maps).
% temporal filtering
The preprocessing steps included high-pass temporal filtering (using a
Gaussian-weighted least-squares straight line) for every run of the visual
localizer (cutoff period of \unit[100]{s}) and naturalistic stimuli (cutoff
period of \unit[150]{s}).
% brain extraction & spatial smoothing
Brain extraction was performed using BET \citep{smith2002bet}, and data from all
three paradigms were spatially smoothed using a Gaussian kernel with a full
width at half maximum of \unit[4.0]{mm}.
% grand mean normalization
A grand-mean intensity normalization was applied to each run of the functional
localizer (four runs, each lasting $\approx$\unit[5]{min}; \ac{tr}=\unit[2]{s})
and naturalistic stimuli (eight runs, each lasting $\approx$\unit[15]{min};
\ac{tr}=\unit[2]{s}).
%
Further analyses on these reproduced times series were performed using Python
(v3.7) scripts that relied on
%
NiBabel v3.2.1 (\href{https://nipy.org}{\url{nipy.org}}),
%
NumPy v1.20.2 (\href{https://numpy.org}{\url{numpy.org}}),
%
Pandas v1.2.3 (\href{https://pandas.pydata.org}{\url{pandas.pydata.org}}),
%
Scipy v1.6.2 (\href{https://scipy.org}{\url{scipy.org}}),
%
scikit-learn v1.0 (\href{https://scikit-learn.org}{\url{scikit-learn.org}}),
%
BrainIAK v0.11
\citep[\href{https://brainiak.org}{\url{brainiak.org}}][]{kumar2020brainiak,
kumar2020brainiaktutorial},
%
Matplotlib v3.4.0 (\href{https://matplotlib.org}{\url{matplotlib.org}}),
%
seaborn v0.11.2 (\href{https://seaborn.pydata.org}{\url{seaborn.pydata.org}}),
%
and calling command line functions of FSL.

%\paragraph{Fixing FSL output}

% grand_mean_for_4d.py (formerly: data_normalize_4d.py):
% is not necessary anymore: FSL has applied grand mean scaling to
% 'filtered_func_data.nii.gz'

% input: 'sub-*/run-?.feat/filtered_func_data.nii.gz' (of VIS, AO & AV)
% output: saved to 'sub-??_task-*_run-?_bold_filtered.nii.gz'

% FSL adds back the mean value for each voxel's time course at the end of the
% preprocessing;
% hence, the script subtracts that mean again but multiplies it by 10000
% (like FSL does it, too)

% definition of grand mean scaling for 4d data:
% voxel values in every image are divided by the average global mean
% intensity of the whole session. This effectively removes any mean global
% differences in intensity between sessions.

% FSL User Guide:
% filtered_func_data will normally have been temporally high-pass filtered,
% it is not zero mean; the mean value for each voxel's time course has been
% added back in for various practical reasons.
% When FILM begins the linear modeling, it starts by removing this mean.

% masks-from-mni-to-bold3Tp2.py:
% - merges unilateral ROIs overlaps (already in MNI) to bilateral ROI
% - output: 'masks/in_mni/PPA_overlap_prob.nii.gz'
% - warps union of ROIs from MNI into each subjects space
% output: 'sub-*/masks/in_bold3Tp2/grp_PPA_bin.nii.gz' + audio_fov.nii.gz dilate
% the ROI masks by 1 voxel; output: 'grp_PPA_bin_dil.nii.gz'

% masks-from-mni-to-bold3Tp2.py:
% warp MNI masks into individual bold3Tp2 spaces

% masks-from-t1w-to-bold3Tp2.py:
% transforms 'inputs/tnt/sub-*/t1w/brain_seg*.nii.gz'
% into individual's bold3Tp2
% output: 'sub-*/masks/in_bold3Tp2/brain_seg*.nii.gz'

% mask-builder-voxel-counter.py:
% builds different individual masks by dilating, merging other masks
% creates a FoV of AO stimulus for every subject from 4d time-series of AO run
% output: sub-*/masks/in_bold3Tp2/audio_fov.nii.gz'
% counts the voxels
% long story short: we cannot used all gyri that contain PPA to some degree
% even if the mask by FoV of AO stimulus and individual gray matter mask

% data_mask_concat_runs.py:
% masks are not dilated and not masked with subject-specific gray matter mask
% outputs:
% 'sub-*_task_aomovie-avmovie_run-1-8_bold-filtered.npy
% 'sub-*_task_visloc_run-1-4_bold-filtered.npy'

% reason why we do it
The \ac{srm} requires that the number of samples (i.e. the number of \acp{tr})
exceed the number of features (the number of voxels).
%
In order to restrict the number of voxels, we created bilateral \acp{roi} for
each subject.
%
Specifically, we warped the union of individual \acp{ppa} \citep[s. Fig. 1
in][]{haeusler2022processing} from MNI space into each subject's voxel space
using subject-specific, non-linear transformation matrices that were previously
computed
\citep[][\href{https://github.com/psychoinformatics-de/studyforrest-data-templatetransforms
}{\url{github.com/psychoinformatics-de/studyforrest-data-templatetransforms}}]{hanke2014audiomovie}.
% applying masks
The time series data of each subject were then masked in their native voxel
space by the union of individual \acp{ppa} and the subject-specific \ac{fov} of
the audio-description.
% voxels = [1665, 1732, 1400, 1575, 1664, 1951, 1376, 1383, 1683, 1887, 1441,
% 1729, 1369, 1437] median = 1619.5
The number of remaining voxels per subject (range 1369--1951,
$\overline{X}=1592$, $SD=188$) can be seen in Fig.~\ref{fig:plot_voxel-counts}.
% normalization
Data of each run were normalized ($z$-scored) to a mean of zero
($\overline{X}=0$) and a standard deviation of one ($SD=1$).
%
Due to an image reconstruction problem \citep[cf.][]{hanke2014audiomovie}, the
last 75 \acp{tr} of the audio-description were missing in subject 04.
%
The \ac{srm} allows for different numbers of voxels across subjects, but the
number of \acp{tr} must be the same.
%
Consequently, we removed the last 75 \acp{tr} of the audio-description from the
time series of all other subjects.
% summary; AO + AV = 7123 TRs (not 7198 TRs anymore); localizer has 4 x 156 TRs
As a result, the data used to fit the \ac{srm} in the next step included 3599
\acp{tr} of the movie, 3524 \acp{tr} of the audio-description, and 624 \acp{tr}
of the visual localizer (7747 \acp{tr} in total).
%% concatenate and z-score
The time series of all three paradigms were concatenated and $z$-scored.

\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/plot_voxel-counts.pdf}
\caption{
%
\textbf{Number of voxels in the bilateral regions of interest (ROIs)
of each subject.}
%
In order to reduce the number of voxels, we warped the union of
individual \acp{ppa} \citep[cf. Fig. 1 in][]{haeusler2022processing} from
MNI space into each subject's native voxel space.
%
The remaining voxels of each subject were further constrained to those
voxels that are included in the respective subject's \ac{fov} of the
audio-description \citep[cf.][]{hanke2014audiomovie}.
}
\label{fig:plot_voxel-counts}
\end{figure*}


\begin{comment}

The number of remaining voxels per subject can be seen in Table
\ref{tab:ppamaskvoxels} (range 1369--1951, $\overline{X}=1592$, $SD=188$).


\begin{table*}[btp] \caption{
%
\textbf{Table heading.}
%
The number of remaining voxels after masking time series data of each paradigm
and subject with the union of individual \acp{ppa} warped from MNI space
into each individual's subjects-space and the subject-specific field of view
of audio-description.
    }

\label{tab:ppamaskvoxels}
\begin{tabular}{ll}
\toprule
\textbf{Subject} & \textbf{no. of voxels} \\
\midrule
sub-01 & 1665 \tabularnewline
sub-02 & 1732 \tabularnewline
sub-03 & 1400 \tabularnewline
sub-04 & 1575 \tabularnewline
sub-05 & 1664 \tabularnewline
sub-06 & 1951 \tabularnewline
sub-14 & 1376 \tabularnewline
sub-09 & 1383 \tabularnewline
sub-15 & 1683 \tabularnewline
sub-16 & 1887 \tabularnewline
sub-17 & 1441 \tabularnewline
sub-18 & 1729 \tabularnewline
sub-19 & 1369 \tabularnewline
sub-20 & 1437 \tabularnewline
\bottomrule
\end{tabular}
    % \caption*{The legend text goes here.}
\end{table*}

\end{comment}


\subsection{Estimation via functional alignment}
%
To estimate the \textit{empirical $Z$-maps} (i.e. the results of the three
$t$-contrast), we followed a three-step procedure.
% create CFS and training subjects' matrices
First, for every fold of the leave-one-out cross-validation (N$=$14 subjects),
we fit a \ac{srm} to $N-1$ training subjects' response response time series of
the movie, the audio-description, and the visual localizer.
% results in...
This step generated a \ac{cfs} for each fold of the cross-validation and a
transformation matrix with orthonormal columns for each training subject.
% align test subject
Second, we aligned the test subject's response time series data from the movie,
audio-description, and visual localizer paradigms separately to the
corresponding \acp{tr} within the \ac{cfs}.
%
This partial alignment with the \ac{cfs} produced different transformation
matrices for the test subject based on data from different paradigms.
% quantity vs. performance
In order to examine the relationship between the estimation performance and the
amount of data used to generate a transformation matrix, we also varied the
number of runs of the paradigms.
%
This additional procedure during step two produced transformation matrices based
on an increasing number of runs per paradigm.
%
In the third step, we estimated a test subject's empirical $Z$-map by first
projecting the training subjects' empirical $Z$-maps from their voxel space into
the \ac{cfs} using their transformation matrices.
% project from CFS into test subject
Then, we projected the training subjects' $Z$-maps from the \ac{cfs} into the
test subject's voxel space using the transpose of the test subject's
transformation matrix (that is equivalent to the inverse of the transformation
matrix due to its orthonormal columns).
% actual prediction
Finally, we obtained the test subject's \textit{predicted $Z$-maps} by
calculating the arithmetic mean of the respective paradigm's projected empirical
$Z$-maps.



\subsubsection{Fitting the SRM}
%
In order to obtain the \ac{cfs} and the training subjects' transformation
matrices, we used the probabilistic \ac{srm} algorithm that is implemented in
BrainIAK v.11 \citep[Brain Imaging Analysis Kit;][]{kumar2020brainiak,
kumar2020brainiaktutorial}, and approximates the \ac{srm} based on the
Expectation Maximization (EM) algorithm as proposed by \citet{chen2015reduced}
and optimized by \citet{anderson2016enabling}.
% number of dimensions / features ``The effect of number of PCs on BSC was
% similar for models that were based only on Princeton (n = 10) or Dartmouth (n
% = 11) data, suggesting that this estimate of dimensionality is robust across
% differences in scanning hardware and scanning parameters''
% \citep{haxby2011common}.
%
% ``These dimensionality estimates are a function of the spatial and temporal
% resolution of fMRI and the number and variety of response vectors used to
% derive the common space'' \citep{guntupalli2016model}.
%
% ``The true dimensionality of representation in human cortex surely involves
% vastly more distinct tuning functions. Estimates of the dimensionality of
% cortical representation, therefore, will almost certainly be much higher as
% data with higher spatial and temporal resolution for larger and more varied
% samples of response vectors are used to build new common models''
% \citep{guntupalli2016model}.
We chose a value of $k=10$ for the number of shared features (i.e. the number of
dimensions in the \ac{cfs}) based on the temporal and spatial resolution of our
data (\ac{tr} = \unit[2]{s}; \unit[2.5 $\times$ 2.5 $\times$ 2.5]{mm}), the
average number of voxels per \ac{roi}, and findings from
\citet{haxby2011common}.
%
\citet{haxby2011common} used hyperalignment to create a \ac{cfs} of 1,000
dimensions based on functional data (\ac{tr} = \unit[3]{s}) of voxels (\unit[3
$\times$ 3 $\times$ 3]{mm}) located in the ventral temporal cortex.
%
They then reduced the dimensionality of the \ac{cfs} by applying a \ac{pca} in
order to determine the subspace that is sufficient to capture the full range of
response-pattern distinctions.
%
Results revealed that approximately 35 principal components (i.e. dimensions)
were sufficient to represent the information content of a one-hour movie from
which the \ac{cfs} was derived.
%
Results also showed that the cortical topographies of category-selective brain
regions was preserved in the 35-dimensional \ac{cfs}.
% ...as judged by visual inspection
In the present study, we also computed \acp{cfs} of $k=5, 20, 30, 40, 50$ but
the prediction performance based on these \acp{cfs} barely varied from a
10-dimensional \ac{cfs}.
% iterations:
The algorithm was set to iterate 30 times to minimize the error.

% correlations of regressors
In order to visualize characteristics of the \ac{cfs}, we calculated the Pearson
correlation coefficients between the shared responses and the regressors that we
previously created \citep[cf.][]{sengupta2016extension, haeusler2022processing}
to model hemodynamic responses during the three paradigms.
%
As an example, we chose the \ac{cfs} that was created in the first fold of the
cross-validation from $N-1$ subjects to estimate the $Z$-maps of subject 01.
%
The time series of the shared features were trimmed to match the corresponding
\acp{tr} of the respective paradigms.
%
Fig.~\ref{fig:corr-vis-reg-srm} shows the correlations between regressors
created to model hemodynamic responses during the visual localizer and shared
responses (trimmed to the \acp{tr} that match the visual localizer).
Fig.~\ref{fig:corr-av-reg-srm} shows the correlations between regressors created
to model hemodynamic responses during the movie \citep[cf. Table 3
in][]{haeusler2022processing} and shared responses, while
Fig.~\ref{fig:corr-ao-reg-srm} shows the correlations between regressors created
to model hemodynamic responses during the audio-description \citep[cf. Table 3
in][]{haeusler2022processing} and shared responses.


\todo[inline]{what do the plots suggest?}

\todo[inline]{make colors of non-used TRs more transparent (alpha=.15)}

% shuffle runs
As a negative control, we created 1000 models based on randomly shuffled time
series.
%
We expected that the \ac{srm} algorithm would yield ``shared'' responses that
are not correlated with the regressors.
%
For each of the 1000 models, the order of runs of the visual localizer and
naturalistic stimuli were shuffled separately for each paradigm and training
subject.
%
Then, we concatenated the time series, fit the \ac{srm}, calculated the Person
correlation coefficients per model, and finally their means across the 1000
models.
%
As hypothesized, the shared features within \acp{cfs} based on shuffled time
series show no or just minor mean correlations with the regressors, as shown in
%
Fig.~\ref{fig:corr-vis-reg-srm-shuffled},
%
Fig.~\ref{fig:corr-av-reg-srm-shuffled}, and
%
Fig.~\ref{fig:corr-ao-reg-srm-shuffled}.


\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/corr_vis-regressors-vs-cfs_sub-01_srm-ao-av-vis_feat10-iter30_7123-7747.pdf}
\caption{
%
\textbf{Pearson correlation coefficients between regressors of the visual
localizer and shared features.}
%
The time series of the shared features within the multi-paradigm \ac{cfs}
%
(as calculated for subject 01 in the first fold of the cross-validation)
%
were trimmed to match the corresponding \acp{tr} of the visual localizer
paradigm \citep{sengupta2016extension}.
%
The six regressors of the visual localizer model hemodynamic responses to
the six categories of pictures that were presented in blocks.
}
\label{fig:corr-vis-reg-srm}
\end{figure*}


\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/corr_av-regressors-vs-cfs_sub-01_srm-ao-av-vis_feat10-iter30_3524-7123.pdf}
\caption{
    %
    \textbf{Pearson correlation coefficients between regressors of the movie
    and shared features}
    %
    The time series of the shared features within the multi-paradigm \ac{cfs}
    %
    (as calculated for subject 01 in the first fold of the cross-validation)
    %
    were trimmed to match the corresponding \acp{tr} of the movie
    \citep{hanke2016simultaneous}.
    %
    The regressors \texttt{vse\_new} to \texttt{vno\_cut} are based on
    annotations movie frames, whereas the regressors
    \texttt{fg\_av\_ger\_lr} to \texttt{fg\_av\_ger\_ud} represent low-level
    visual or auditory confounds
    \citep[cf. Table 3 in][]{haeusler2022processing}.
    %
    \texttt{vse\_new}: change of the camera position to a setting not depicted
    before;
    \texttt{vse\_old}: change of the camera position to a recurring setting;
    %
    \texttt{vlo\_ch}: change of the camera position to another locale within
    the same setting;
    %
    \texttt{vpe\_new}: change of the camera position within a locale not
    depicted before;
    %
    \texttt{vpe\_old}: change of the camera position within a recurring locale;
    %
    \texttt{vno\_cut}: frames within a continuous movie shot;
    %
    \texttt{fg\_av\_ger\_lr}: left-right luminance difference;
    %
    \texttt{fg\_av\_ger\_lrdiff}: left-right volume difference;
    %
    \texttt{fg\_av\_ger\_ml}: mean luminance;
    %
    \texttt{fg\_av\_ger\_pd}: perceptual difference;
    %
    \texttt{fg\_av\_ger\_rms}: root mean square volume;
    %
    \texttt{fg\_av\_ger\_ud}: upper-lower luminance difference.
    }
\label{fig:corr-av-reg-srm}
\end{figure*}


\begin{figure*}[tbp]
\centering
\includegraphics[width=\linewidth]{figures/corr_ao-regressors-vs-cfs_sub-01_srm-ao-av-vis_feat10-iter30_0-3524.pdf}
\caption{
    %
    \textbf{Pearson correlation coefficients between regressors of the
    audio-description and shared features.}
    %
    The time series of the shared features within the multi-paradigm \ac{cfs}
    %
    (as calculated for subject 01 in the first fold of the cross-validation)
    %
    were trimmed to match the corresponding \acp{tr} of the
    audio-description \citep{hanke2014audiomovie}.
    %
    The regressors \texttt{body} to \texttt{sex\_m} are based on
    annotated classes of nouns spoken by the audio-description's narrator,
    whereas the regressors \texttt{fg\_ad\_ger\_lrdiff} and
    \texttt{fg\_ad\_ger\_rms} represent low-level auditory confounds
    \citep[cf. Table 3 in][]{haeusler2022processing}.
    %
    \texttt{body}: trunk of the body; overlaid clothes;
    %
    \texttt{bpart}: limbs and trousers;
    %
    \texttt{fahead}: (parts) of the face or head;
    %
    \texttt{furn}: moveable furniture (insides \& outsides);
    %
    \texttt{geo}: immobile landmarks;
    %
    \texttt{groom}: rooms \& locales or geometry-defining elements;
    %
    \texttt{object}: moveable and countable entities with firm boundaries;
    %
    \texttt{se\_new}: a setting occurring for the first time;
    %
    \texttt{se\_old}: a recurring setting;
    %
    \texttt{sex\_f}: female name, female person(s);
    %
    \texttt{sex\_m}: male name, male person(s);
    %
    \texttt{fg\_ad\_lrdiff}: left-right volume difference;
    %
    \texttt{fg\_ad\_rms}: root mean square volume.
    %
    \texttt{geo\&groom} is a combination of regressors as used on the positive
    side of the primary contrasts aimed at localizing the \ac{ppa}
    \citep[cf. Table 5 in][]{haeusler2022processing}.
    }
\label{fig:corr-ao-reg-srm}
\end{figure*}


\subsubsection{Alignment of the test subject}

% AO: 0-451, 0-892, 0-1330, 0-1818, 0-2280, 0-2719, 0-3261, 0-3524
% AV: 3524-3975, 3524-4416, 3524-4854, 3524-5342, 3524-5804, 3524-6243,
%     3524-6785, 3524-7123
% AO+AV: 0-7123

% in-code documentation of
% https://github.com/brainiak/brainiak/blob/master/brainiak/funcalign/srm.py
% says: # Solve the Procrustes problem; A =
% subjectFMRIdata.dot(SharedResponses.T) U, \_, V = np.linalg.svd(A,
% full\_matrices = False) return U.dot(V)

%
We aligned the test subject's response time series from the visual localizer,
the movie, or the audio-description to the corresponding \acp{tr} within the
\ac{cfs} by factorizing the response time series data via singular value
decomposition.
%
This step produced transformation matrices with orthonormal columns that allow a
linear transformation of data from a test subject's voxel space into the
\ac{cfs}.
%
To investigate how the amount of data used to acquire a transformation matrix
affects the estimation performance, we also varied the number of runs per
paradigm.
%
Specifically, we used
%
one up to four runs (each lasting $\approx$\unit[5]{min}) of the visual
localizer, and
%
one up to eight runs (each lasting $\approx$\unit[15]{min}) of the naturalistic
stimuli
%
to align the test subject's time series with the corresponding \acp{tr} within
the \ac{cfs}.
%
Therefore, for each test subject, we obtained four matrices based on data from
the visual localizer and eight different matrices per naturalistic stimulus,
each transformation matrix having a size of $v$ voxels by $k$ shared responses
but being based on an increasing amount of data used to calculate the linear
transformation.


\subsubsection{Estimation of the test subject's $Z$-maps}

% overview
We estimated the empirical $Z$-maps of the test subject by projecting the
empirical $Z$-maps of all training subjects trough the \ac{cfs} into the test
subject's voxel space.
% functional alignment; into CFS (calling srm.transform(masked\_zmaps))
First, we masked the empirical $Z$-maps of the training subjects with the same
subject-specific masks that we used to mask the time series data.
%
Then, we used the transformation matrices derived during the training of the
\ac{cfs} to map the masked empirical $Z$-maps from each training subject's voxel
space into the \ac{cfs}.
%
Next, we used the transpose of a transformation matrix obtained from the
alignment of the test subject to project the $Z$-maps from the \ac{cfs} into the
test subject's voxel space.
% take the mean
For each of the three $t$-contrasts, we obtained the test subject's predicted
$Z$-map by calculating the arithmetic respective paradigm's projected empirical
$Z$-maps.



\subsection{Estimation via anatomical alignment}
%
As a baseline, we used an anatomical alignment procedure to estimate a test
subject's empirical $Z$-maps.
%
First, we projected the masked empirical $Z$-maps of each paradigm and each
training subject from their native voxel space into the MNI space via previously
computed subject-specific transformation matrices
\citep[][\href{https://github.com/psychoinformatics-de/studyforrest-data-templatetransforms}{\url{github.com/psychoinformatics-de/studyforrest-data-templatetransforms}}]{hanke2014audiomovie}.
% from MNI into subject
We then used the test subject's pseudoinverse transformation matrix to project
the data from MNI space into the test subject's voxel space.
% take the mean
Similar to our functional alignment procedure, we obtained an estimation of the
test subject's empirical $Z$-maps by taking the arithmetic mean of the
respective paradigm's projected $Z$-maps.



\subsection{Cronbach's $\alpha$ of the empirical $Z$-maps}
%
We calculated Cronbach's $\alpha$ as a measure of reliability and the amount of
measurement error \citep{cronbach1951coefficient, cortina1993coefficient}
present in the empirical $Z$-maps of each paradigm and subject.
%
Cronbach's $\alpha$ expresses the expected correlation between the currently
used empirical $Z$-maps and an additional set of empirical $Z$-maps calculated
based on data of a hypothetical independent dataset collected from the same
paradigm and subjects \citep{jiahui2020predicting, jiahui2022cross}.
%
These expected correlations, represented by Cronbach's $\alpha$, were calculated
based on the first-level \ac{glm} $Z$-maps (four in case of the visual
localizer; eight in case of the naturalistic stimuli) that were averaged in the
second-level \ac{glm} analyses of \citet{sengupta2016extension} and
\citet{haeusler2022processing} respectively.
%
Cronbach's $\alpha$ of empirical (i.e. second-level) $Z$-maps for each subject
and paradigm can be seen in Fig.~\ref{fig:cronbachs}, descriptive statistics
across subjects for each paradigm can be seen in Table~\ref{fig:cronbachs}.

% The Cronbach's $\alpha$ values for each paradigm are as follows:
% For the visual localizer, the mean is 0.899990 with a standard deviation of
% 0.087051. The minimum value is 0.658523, the 25th percentile is 0.906643, the
% median is 0.934019, the 75th percentile is 0.947906, and the maximum is
% 0.963065.

% For the movie paradigm, the mean is 0.611332 with a standard deviation of
% 0.137878. The minimum value is 0.284440, the 25th percentile is 0.555529, the
% median is 0.627240, the 75th percentile is 0.676353, and the maximum is
% 0.800254.
% movie's outlier: sub-06 (0.28); but when movie PPA is predicted he / she is
% not the outlier

% For the audio-description paradigm, the mean is 0.476194 with a
% standard deviation of 0.358019. The minimum value is -0.526626, the 25th
% percentile is 0.428975, the median is 0.627799, the 75th percentile is
% 0.679987, and the maximum is 0.823584.
% audio-description's outlier: sub-05 (-0.5!), sub-02 (0.0), sub-20 (0.27);
% when audio PPA is predicted, these three subjects are the outliers


\begin{figure*}[tbp] \centering
    \includegraphics[width=\linewidth]{figures/plot_cronbachs.pdf}
    \caption{\textbf{Cronbach's $\alpha$ of the empirical $Z$-maps for each
    paradigm and subject.}
    %
    Cronbach's $\alpha$ was calculated based on the $Z$-maps yielded by the
    first-level \ac{glm} analyses of the visual localizer
    \citep[four runs;][]{sengupta2016extension} and naturalistic stimuli
    \citep[eight runs;][]{haeusler2022processing}.
    %
    The second-level \ac{glm} analyses across runs yielded the empirical
    $Z$-maps that were estimated in the present study.
    }
\label{fig:cronbachs}
\end{figure*}


\begin{table*}[btp]
\centering
    \caption{
    %
    \textbf{Descriptive statistics of Cronbach's $\alpha$ across subjects.}
    %
    Cronbach's $\alpha$ of the empirical $Z$-maps that are the result of the
    second-level \ac{glm} analyses performed in
    \citet{sengupta2016extension} and \citet{haeusler2022processing}. Values of
    Cronbach's $\alpha$ were calculated based on the first-level $Z$-maps (four
    in case of the visual localizer; eight in case of the naturalistic stimuli)}
\label{tab:cronbachs}
\begin{tabular}{llll}
    \toprule
    \textbf{statistic} & \textbf{localizer} & \textbf{movie} & \textbf{audio-description} \\
    \midrule
    mean & 0.90 & 0.61 & 0.48 \tabularnewline
    std & 0.09 & 0.14 & 0.36 \tabularnewline
    min & 0.66 & 0.28 & -0.53 \tabularnewline
    25\% & 0.91 & 0.56 & 0.43 \tabularnewline
    50\% & 0.93 & 0.63 & 0.63 \tabularnewline
    75\% & 0.95 & 0.68 & 0.68 \tabularnewline
    max & 0.96 & 0.80 & 0.82 \tabularnewline
    \bottomrule
\end{tabular}
     % \caption*{The legend text goes here.}
\end{table*}



\section{Results}


\begin{comment}

``Because the localizer task comprises several scanning runs, we calculated the
reliability of the localizer across runs with Cronbach's $\alpha$ to provide an
estimate of the noise ceiling for these correlations'' \citep{jiahui2022cross}.

\end{comment}


The unthresholded $Z$-maps in their respective subject's voxel space can be
accessed at
\href{https://identifiers.org/neurovault.collection:12340}{\url{neurovault.org/collections/12340}}.
\todo{empty}
%
In order to assess the performance of the alignment procedures, we calculated
the Pearson correlation coefficients between each individual's empirical
$Z$-maps obtained from the previous analyses \citep{haeusler2022processing,
sengupta2016extension} and their respective predicted $Z$-maps (s.
Fig.~\ref{fig:stripplot}).
%
In general, the mean Pearson correlation coefficients vary depending on the
criterion being estimated (i.e. $Z$-maps of the visual localizer, movie, or
audio-description), as well as the alignment procedure (anatomical vs.
functional alignment).
%
In the case of functional alignment, the quantity of the paradigm's data used as
a predictor and to align a test subject to the \ac{cfs} also affects the
correlation coefficients.
%
However, the functional alignment procedure consistently shows an increasing
estimation performance across criteria as more data of a predictor is used to
align the test subjects.
%
In order to investigate potential differences between some conditions, we
conducted 15 pairwise comparisons using Fisher z-transformed correlation values.
%
These comparisons were not pre-planned, but rather were selected later as
examples for further exploration.
%
We used a Bonferroni correction for multiple comparisons to adjust the alpha
level to an $\alpha$ of $0.05 / 15 = 0.00\overline{3}$.


\begin{figure*}[tbp] \centering
    \includegraphics[width=\linewidth]{figures/plot_corr-emp-vs-estimation.pdf}
    \caption{
    %
    \textbf{Correlations between empirical and predicted
    \textit{\textbf{Z}}-maps for each subject and paradigm.}
    %
    Functional alignment was performed based on an increasing amount of
    functional data used to align a test subject to the common functional space
    (CFS):
    each of the four runs of the visual localizer paradigm lasted
    $\approx$\unit[5]{min} (\ac{tr}=\unit[2]{s});
    each of the eight runs of the naturalistic stimuli lasted
    $\approx$\unit[15]{min} (\ac{tr}=\unit[2]{s}).
    %
    Solid horizontal lines:
    %
    median of Cronbach's $\alpha$ across subjects the for empirical $Z$-maps of
    the respectively estimated paradigm (cf. Fig.~\ref{fig:cronbachs}).
    %
    Dotted horizontal lines:
    %
    mean of Cronbach's $\alpha$ across subjects for the empirical $Z$-maps of
    the respectively estimated paradigm (cf. Fig.~\ref{fig:cronbachs}).
    %
    Grey dots:
    %
    correlations between empirical $Z$-maps and an estimation using anatomical
    alignment.
    %
    Green dots:
    %
    correlations between empirical $Z$-map and an estimation using functional
    alignment based on transformations calculated from one up to four
    runs of the visual localizer.
    %
    Red dots:
    %
    correlations between empirical $Z$-map and an estimation using functional
    alignment based on transformations calculated from one up to eight runs
    of the movie.
    %
    Blue dots:
    %
    correlations between empirical $Z$-map and an estimation using functional
    alignment based on transformations calculated from one up to eight runs
    of the audio-description.
    }
\label{fig:stripplot}
\end{figure*}


% localizer: localizer data
When estimating the $Z$-maps of the visual localizer, the mean correlation
between empirical $Z$-maps and $Z$-maps predicted using $\approx$\unit[15]{min}
of the visual localizer (within-paradigm prediction) was significantly higher
than the mean correlation between empirical $Z$-maps and $Z$-maps predicted via
an anatomical alignment ($t(14)=\nprounddigits{2}\numprint{13.99}$, $p<.0001$).
% localizer: movie data
Similarly, the mean correlation between empirical $Z$-maps and $Z$-maps
predicted using $\approx$\unit[15]{min} of the movie (cross-paradigm prediction)
was significantly higher than the correlations between empirical $Z$-maps and
$Z$-maps predicted via anatomical alignment ($t(14)=6.35$, $p<.0001$).
%
A comparison between the prediction based on $\approx$\unit[15]{min} of the
movie and $\approx$\unit[15]{min} of localizer data revealed a significantly
lower performance of functional alignment using the movie ($t(14)=-11.64$,
$p<.0001$).
%
The prediction performance based on $\approx$\unit[30]{min} of the movie was
significantly higher than the prediction performance based on
$\approx$\unit[15]{min} of the movie ($t(14)=5.49$, $p=.0001$), with no
significant difference between $\approx$\unit[45]{min} and
$\approx$\unit[30]{min} of the movie ($t(14)=0.13$, $p=.8990$).
% localizer: audio data
Visual inspection indicated that the prediction performance based on
$\approx$\unit[15]{min} of the audio-description was lower than the prediction
performance based on anatomical alignment, functional alignment using
$\approx$\unit[15]{min} of the localizer, or $\approx$\unit[15]{min} of the
movie.
%
However, the prediction performance of the audio-description increased
monotonically the more data were used to align the test subjects.
%
A $t$-test comparing the prediction performance based on
$\approx$\unit[120]{min} of the audio-description to anatomical alignment
yielded no significant difference ($t(14)=-1.17$, $p=.2640$).

%
When estimating the $Z$-maps of the movie, the mean correlation between
empirical $Z$-maps and predicted $Z$-maps using $\approx$\unit[15]{min} of the
movie (within-paradigm prediction) were significantly higher than the
correlations between empirical $Z$-maps and predicted $Z$-maps via an anatomical
alignment ($t(14)= 5.78$, $p<.0001$).
%
Comparing the within-paradigm prediction using $\approx$\unit[15]{min} of the
movie to the cross-paradigm prediction using $\approx$\unit[15]{min} of the
localizer revealed a higher prediction performance when using the movie data for
alignment ($t(14)=5.53$, $p<.0001$).
%
There was no significant difference between the prediction using
$\approx$\unit[15]{min} of the localizer and the prediction via anatomical
alignment ($t(14)=1.15$, $p=.2726$).
%
The prediction performance based on $\approx$\unit[30]{min} of movie data was
significantly higher than the prediction performance based on
$\approx$\unit[15]{min} of the movie ($t(14)= 3.75$, $p=.0024$), whereas there
was no significant difference between the performance based on
$\approx$\unit[45]{min} and $\approx$\unit[30]{min} of the movie ($t(14)=2.58$,
$p=.0230$).
%
As is evident by visual inspection, the prediction performance based on
$\approx$\unit[15]{min} of the audio-description was lower than a prediction
based on anatomical alignment, functional alignment using
$\approx$\unit[15]{min} of the localizer, or functional alignment using
$\approx$\unit[15]{min} of the movie.
%
Here again, the prediction performance of the audio-description monotonically
increased the more data were used to align the test subjects.
%
A $t$-test comparing the prediction performance based on
$\approx$\unit[120]{min} of the audio-description to a prediction via anatomical
alignment yielded no significant difference ($t(14)=-2.40$, $p=.0318$).

%
When estimating the $Z$-maps of the audio-description, the mean correlation
between empirical $Z$-maps and predicted $Z$-maps via $\approx$\unit[15]{min} of
the audio-description (within-paradigm prediction) was not significantly
different to the mean correlation between empirical $Z$-maps and predicted
$Z$-maps via anatomical alignment ($t(14)=-1.82$, $p=.0925$).
%
Comparing the prediction based on $\approx$\unit[120]{min} of the
audio-description to the anatomical alignment procedure yielded a significantly
higher performance of the estimation via functional alignment ($t(14)=6.56$,
$p<=.0001$).
%
Comparing the prediction based on functional alignment via
$\approx$\unit[120]{min} of the movie to the anatomical alignment procedure
yielded no significant difference ($t(14)=-0.76$, $p=.4625$).




\section{Discussion}

\subsection{Introductory paragraph}

\begin{comment}

\subsubsection{Longer version of the introductory paragraph}
%
We investigated the performance of a functional alignment procedure that we used
to predict results of $t$-contrasts (i.e. the criteria) that were created in
previous studies \citep{sengupta2016extension, haeusler2022processing} in order
to localize the \ac{ppa}.
%
Following a leave-one-subject-out cross-validation, we fit a \acf{srm}
\citep{chen2015reduced} to the training subjects' concatenated response
time series of three different paradigms in order to create a multi-paradigm
\acf{cfs} and the training subjects' subject-specific transformations.
%
In order to acquire the test subject's transformation, we used an
increasing amount of the test subject's response time series of the three
paradigms (i.e. the predictors) separately by functionally aligning the test
subject to the corresponding \acp{tr} of the shared feature space (i.e.
\ac{cfs}).
%
The empirical $Z$-maps of each training subject were projected from their
respective voxel space through the \ac{cfs} into the test subject's voxel space
to yield the test subject's predicted $Z$-maps.
%
In case of the anatomical alignment approach that served as a baseline, the
training subjects' $Z$-maps were projected via nonlinear, volume-based
transformation through the MNI space into the test subject's voxel
space.

\end{comment}


\subsubsection{Problem}
%
Traditionally, block-design functional localizer paradigms are used to identify
the topography of functional areas in individual persons.
%
However, a functional localizer paradigm is usually limited to mapping only one
domain of brain functions, and its diagnostic quality heavily depends on a
participant's comprehension of the task instructions and general compliance.


\subsubsection{We: Approach / proposed solution}
%
In the present study, we focused on the \ac{ppa} as an example of a
higher-visual area, and investigated an approach to estimate the results of
$t$-contrasts (i.e. $Z$-maps) in an individual by leveraging data collected from
a reference group.
%
The approach employs a functional alignment based on the \acf{srm}
\citep{chen2015reduced} to address the issue of functional-anatomical
variability across persons and projects $Z$-maps of the reference group through
a \ac{cfs} into an individual's brain anatomy.
%
Given that acquiring functional data from a two-hour paradigm to functionally
align an individual with a \ac{cfs} may not be desirable or feasible, we also
investigated the relationship between the quantity of data used to align an
individual and the subsequent estimation performance.


\subsubsection{Results}

%
We found that using a partial alignment approach with a multi-paradigm \ac{cfs}
derived from concatenated time series of multiple paradigms is effective.
%
The prediction performance improves as more data from the paradigms used to
align a test subject included.
%
However, one movie run (a.k.a. 15 min) outperformed an estimation using
anatomical alignment.



\subsubsection{One sentence conclusion}

%
This opens up the possibility of estimating results from many localizer
paradigms using a naturalistic stimulus of similar duration of one traditional
localizer paradigm.
%
By leveraging the data from this reference
group, it becomes possible to identify and characterize the functional area of
interest without the need for extensive scanning sessions for each individual.
%
This method offers a more efficient and cost-effective solution while still
providing valuable insights into individual brain functional anatomy.



\subsection{Criterion: visual localizer}

\todo[inline]{the "gold" standard; focus (esp. in length) on visual localizer;
movie and audio PPA are a bonus!}

\todo[inline]{results are in line with \citet{haxby2011common}}

\todo[inline]{define "predictors", "criteria", "multi-paradigm \ac{cfs} again
(implicitly)}

\todo[inline]{calculate mean (z-transformed) correlation per paradigm for
anatomical alignment; it $r\approx$\unit[0.6.] for each paradigm}

As a baseline, we used an anatomical alignment procedure to estimate the results
of all three criteria ($Z$-maps of the visual localizer, movie,
audio-description).
%
In general, the anatomical alignment revealed a decent / robust performance and
comparatively low variance across criteria [insert mean correlations per
paradigm here; $\approx$\unit[0.6.]].
%

Using $\approx$\unit[15]{min} of localizer data to align a test subject to a
\ac{cfs} and estimate $Z$-maps of the localizer (within-paradigm prediction)
outperforms an procedure based on anatomical alignment.
%
And outperforms functional alignment via movie.
%
Inference; in line with results from \citep{haxby2011common}.

%
When estimating the visual localizer, results indicate that
$\approx$\unit[15]{min} (\ac{tr}=2s) of movie watching used for
functional alignment outperform prediction using anatomical alignment.
%
Prediction performance further increases when
$\approx$$\approx$\unit[30]{min} of movie data submitted to the algorithm to
calculate the subject-specific transformations.
%
However, three runs ($\approx$45 minutes) do not lead to an significantly
increased estimation performance suggesting a decreasing benefit of longer
scanning time than $\approx$\unit[30]{min} during audio-visual naturalistic
stimulation.
%
A cross-paradigm paradigm prediction based on $\approx$\unit[15]{min}
of movie data also outperforms a procedure based on anatomical alignment.
%
Further, results also show that the prediction performance increases the more
data are used to align the test subjects but with no statistically significant
difference between 30 and 45 minutes.
%
Results suggest that the functional alignment based on movie data does approach
a limit and therefore does not benefit from presenting a whole naturalistic
stimulus.
%
Inference: efficiency and stuff (cf. introduction); movie is awesome: immersive
and no task; worse than within-prediction but acceptable
loss of prediction performance; possibly applicable to lots of other (visual?)
paradigms.

%
We also tested cross-modal prediction of a non-visual naturalistic paradigm;
%
the audio-description shows lower prediction performance than anatomical
alignment, and a functional alignment based on localizer data and movie data.
%
the more audio-description data are used the better the performance while also
closing the gap to the prediction based on movie data.
%
There might be no difference between the performance of an anatomical alignment
and 120 minutes of audio data, however results suggest it is not a good idea to
use our procedure to potentially substitute a visual paradigm with an
exclusively auditory paradigm to estimate results of a visual paradigm.
%
In general it works, but results suggest a lot of data are necessary to acquire
a comparable estimation performance that could be obtained by mere anatomical
scans.


\subsection{Criterion: movie \& audio-description}

\todo[inline]{needs to be in line with general discussion's pros \& cons of
naturalistic stimuli}

\todo[inline]{Lower Cronbach's; more naturalistic but highlights challenges of
naturalistic stimuli: varying degree of events per runs; hard to model; no task}

\todo[inline]{What did the person's actually do during the experiment? Control
of audibility, alertness etc..; it's not that task-free; keeping attention when
merely listening without visual salient screen catching attention with
movement's etc.}

\todo[inline]{we aligned on average x voxel without a prior anatomical
alignment (and spheres for searchlight cf \citet{guntupalli2016model}; how did
\citet{haxby2011common} do it?; so maybe that's the reason why we need a
shit ton of data and anatomical alignment seems to be robust)}

%
We also estimated the results from \citet{haeusler2022processing} where we built
$t$-contrast aimed at localizing the \ac{ppa} based on modeled hemodynamic
activity based on stimulus annotations of the two naturalistic stimuli.

%
The mean prediction performance of the anatomical alignment when
estimating the results of the naturalistic paradigms is similar to the
prediction performance when estimating the dedicated localizer paradigm.


\subsubsection{Criterion: movie}

\subsubsection{Criterion: audio-description}

\todo[inline]{naturalistic plus non-visual}

\todo[inline]{cf. time series plot of shared responses 1 to 3! not as
synchronized (smeared?) or not a strong as during visual paradigms}

%
Using the audio-description for functional alignment to estimate visual
paradigms/cross-modal by using data from a non-visual paradigm is a challenging
task.
%
However, the estimation performance increases with the availability of
more data.
%
One possible explanation could be that the audio-description lacks visual
stimulation and is not as rich as the movie (or response are of less amplitude)
%
Another explanation is that the response in the PPA to a auditory paradigm is
(too) different from a response in the PPA to a visual paradigm.
%
Nevertheless, the data collected during listening to an audio-description, which
is richer than a mere narrative, could potentially be used to estimate a visual
category-selective area. However, the current approach requires impractical
amounts of data.


\todo[inline]{in summary, limited suitability to substitute a visual paradigm}

%
It would be interesting to estimate the results from a controlled speech
paradigm, i.e., another same-modality criterion.

\subsubsection{Problems with naturalistic stimuli}

\todo[inline]{more severe in case of the audio-description}

%
Notably, these alternative procedures to localize the \ac{ppa} revealed mediocre
to poor reliability in some subjects.
%
When estimating audio PPA, participants with poor Cronbach's $\alpha$ have the
lowest correlation between predicted and empirical $Z$-maps.
%
These participants are not "reliable outliers deviant from the norm" but may be
considered as unreliable outliers due to their noisy data.
%
Therefore, the SRM may be performing some level of denoising instead of modeling
these unreliable outliers incorrectly.

%
Was the construct "perception of auditory spatial information" modeled
insufficiently in \citet{haeusler2022processing}?
%
The primary audio-description contrast yielded bilateral clusters in nine
participants that overlapped with the block-design localizer results, and one
cluster in the left-hemispheric PPA for one participant (sub-09). Thus, it seems
that the construct was sufficiently modeled for more than 50\%.
%
The fact that it worked for most subjects suggests that the issue is not a
methodological decision and that the audio-description does sample the responses
to spatial information.
%
Rather, it is more likely an issue with the naturalistic paradigm, which allows
for more individual variation over the course of the two-hour long stimulation,
possibly influenced by an unbalanced number of events per stimulus runs.
%
Although the shared responses show the highest correlation with the regressors
of the visual localizer, the plots of shared responses and regressors of the
audio-description (cf. Fig.~\ref{fig:corr-ao-reg-srm}) suggest that the shared
responses during TRs of the audio-description are not entirely noise but that
the shared features during TRs of the movie and audio-description seem to be
more abstract.
%
Final point: given that the within-paradigm prediction works well for most
subjects, outliers of Cronbach's $\alpha$ do not significantly degrade the
model.

%
Perhaps the large individual variability observed in some subjects during the
audio-description paradigm is due to the paradigm itself, which allows for more
variation over the two-hour long stimulation.
%
Another possibility is that the 2-hour long auditory stimulation is not as
immersive or engaging as the multi-modal audio-visual movie.
%
A potential challenge in controlling for these factors is the difficulty in
judging or controlling attentional focus compared to eye-tracking during a
movie.
%
However, it may be possible to measure alertness using EEG recordings.
%
Alternatively, it could be related to the auditory domain in general, although
this is difficult to determine precisely and needs a dedicated paradigm, imo.


\paragraph{Just a bold inference}

\todo[inline]{more unreliable criteria need more data to reach an estimation
performance that is as good or better than anatomical alignment????}

\todo[inline]{add text about SRM as denoising technique?}
%
The current results suggest that the processing of auditory spatial information
is reliably engaged across subjects during the audio-description and in such a
way that the ``SRM will improve sensitivity for detecting a cognitive process of
interest in the test data'' \citep{cohen2017computational}.

%
Present results support evidence that results in \citet{haeusler2022processing}
that are restricted to the anterior part of the localizer PPA are not based on
the methodological decisions, and that the responses to auditory spatial
information lead to different activity patterns than visual stimulation.
%
Further studies using controlled paradigms are needed to investigate auditory
spatial information and studies using auditory narratives should employ more
sophisticated models of event structure in order to assess the suitability of
naturalistic stimuli as a "true naturalistic localizer".
%
It is important to note that the use of naturalistic stimuli in research can
provide more ecologically valid results, but it is also important to consider
potential confounds and limitations leading to problems we have to struggle with
here when trying to interpret the results.




\subsection{Interim summary (on functional alignment)}

\todo[inline]{in principle it is possible to use a auditory paradigm to predict
visual paradigm but does not really make sense; interesting would be to test
how far you can take the movie to generalize to other non-visual localizer, and
especially compare performance of narrative / movie when estimating speech
localizer}


Our results provide evidence that transformation matrices calculated based on
data from naturalistic stimuli promise an increased validity and [or?]
generalizability for functional alignment over transformation matrices based on
data of a controlled paradigm based on simplified stimuli.
%
This is the case for both within-paradigm prediction (e.g., audio-description
for alignment to estimate $Z$-maps from the audio-description's $t$-contrast)
and cross-paradigm prediction (e.g. audio-description for alignment to estimate
$Z$-maps from the visual localizer's $t$-contrast).
%
Our results are different results of \citet{haxby2011common} who found that the
prediction of $Z$-maps from a controlled paradigm via matrices \& \ac{cfs} based
on the same controlled paradigm was as good or better than prediction (of the
same) $Z$-maps via matrices \& \ac{cfs} based on movie data.
%
In summary, the multi-stimulus \ac{cfs} generalizes over paradigms to be
estimated but performance depends on the paradigm used to align the test subject
to the \ac{cfs}.




\subsection{Future questions}

\todo[inline]{just some ideas...}

Our results are preliminary!

\subsubsection{Bigger sample size}

\todo[inline]{Sample size for the SRM as varying parameter}

%
The SRM is computationally less demanding [= "computationally more efficient"?]
than hyperalignment, an advantage for scientists who want to replicate our
results but do not have access to a high-performance computer cluster [or
"high-throughput computer cluster" or simply "specialized hardware"?].
%
Moreover, it should scale pretty well to bigger sample sizes; compared to, for
example, \citet{jiahui2020predicting, jiahui2022cross} 1-step hyperalignment
alignment that needs pair-wise matrices for subjects (because no CFS).


Functional alignment via movie (and visual localizer) to predict results of a
other domains, e.g. speech localizer?
%
How far can we push it?


\subsubsection{Other ROIs than category-selective areas}

\todo[inline]{topic for general discussion: limit of naturalistic stimuli
(passively consumed)?}


\begin{comment}

\paragraph{Results of \citet{frost2012measuring}}
%
``We localized 13 widely studied functional areas and found a large variability
in the degree to which functional areas respect macro-anatomical boundaries
across the cortex.
%
The percent gain in overlap [after surface-based alignment] differed greatly
across the different functional regions throughout the cortex.
%
There is a strong structural-functional correspondence in some areas whilst in
others the spatial location of the functional area is not tightly bound to
anatomical landmarks and varies greatly across subjects within a cortical area''
\citep{frost2012measuring}.
%
Language areas were found to vary greatly across subjects whilst a high degree
of overlap was observed in sensory and motor areas.
%
PPA gained 17.6\% in the left and 27.7\% in the right hemisphere.
%
The FFA gained 44.1\% in the left and 12\% in the right hemisphere.
%
The FFA did not exhibit the same strong structural-functional correspondence and
saw more modest increases in overlap after macro-anatomical alignment.
%
FFA varies in its location along the length of the fusiform gyrus even though
the gyri themselves are well aligned across subjects.
%
LOC gained 62.7\% in the left and 38.4\% in the right hemisphere''
\citep{frost2012measuring}.

% category-specific areas
Similar to nonlinear volume-based alignment, similarity across person is higher
after surface-based alignment ``for retinotopically defined regions, with
character-selective regions showing the lowest consistency for both alignments,
closely followed by mFus- and IOG-faces'' \citep{rosenke2021probabilistic}.

\end{comment}

%
In the present study, we focused on the \ac{ppa} as a classic example of a
higher-visual area.
%
It is important to note that the alignment procedure may perform differently
when estimating other functional areas.
% varying \textit{functional--anatomical correspondence}
Previous studies have shown that there is a varying degree of correspondence
between a brain function and its underlying anatomical location.
%
Previous studies that used either volume-based \citep{zhen2017quantifying,
zhen2015quantifying} or surface-based alignment \citep{rosenke2021probabilistic,
frost2012measuring} to estimate the location of functional areas have ``found a
large variability in the degree to which functional areas respect
macro-anatomical boundaries across the cortex'' \citep{frost2012measuring}.
%
In some areas, there is a strong structural-functional correspondence, while in
others, the spatial location of the functional area varies greatly across
subjects within a cortical area \citep{frost2012measuring}
%
For example, even within in the domain of category-selective areas, the
interindividual variability varies across functional areas
\citep{zhen2017quantifying, zhen2015quantifying, frost2012measuring}:
%
For instance, in the domain of category-selective areas, interindividual
variability varies across functional areas , with scene-selective regions
showing larger variability in spatial topography compared to face-selective
regions \citep{zhen2017quantifying, frost2012measuring}.


\paragraph{Inference}

\todo[inline]{cite a review that summarizes research the range of brain studied
using naturalistic stimuli}

%
Therefore, future studies could investigate the extent to which functional
alignment leads to an increased estimation performance compared to anatomical
alignment, especially in areas where the functional-anatomical correspondence is
known to vary across subjects.
%
Naturalistic stimuli have been used to investigate a variety of domains like XYZ
[check for, e.g., visual or auditory perception, spatial cognition; emotion;
music, speech or social perception], and possibly allow valid mapping of
functional data in all of these domains.


\todo[inline]{Paraphrase:}
%
``There are numerous other functional localizers in other perceptual and
cognitive domains, such as simple visual motion, biological motion, tonotopy,
voice perception, music perception, language, calculations, working memory, and
theory of mind.
%
Because naturalistic movies include people, human actions, conversations, social
interactions, background music etc., we predict functional alignment based on
movies also will work for localizers of functional topographies for audition,
language, and social cognition.
%
Some high-level cognitive processes, such as calculation, working memory, and
logical reasoning, may be less well sampled by movie viewing, and further work
is necessary to test whether hyperalignment based on movie-viewing data can be
used to estimate topographies for these other domains of high-level cognition.
%
Researchers may need to select or develop movies that involve more calculations
or logical inference-making to afford accurate estimation of topographies in
these domains'' \citep{jiahui2020predicting}.


\paragraph{Studyforrest dataset's other localizer t-contrasts}

\todo[inline]{it is such a low-hanging fruit; better drop it?}

For instance, the visual localizer of the studyforrest dataset also contains
contrast that aimed at localizing the \ac{ffa} and \ac{ofa} that are associated
with face perception \citep{kanwisher1997ffa, pitcher2011occipitalfacearea}, the
\ac{eba} that is associated with the perception of human bodies
\citep{downing2001bodyarea}, and the \ac{loc} that is associated with the
perception of (small) objects (like tools or toys) \citep{malach1995loc},
%
The subject-specific \acp{roi} masks for these areas that where created by
\citep{sengupta2016extension} and our analysis pipeline we used in
\citet{haeusler2022processing} provide an opportunity for future studies (e.g.,
a master's thesis or part of a PhD project) to explore the hemodynamic responses
that correlate with auditory information related to faces, body parts, or small
objects.



\subsubsection{Other functional alignment algorithms}

\todo[inline]{a big treatise on functional alignment algorithms should
definitively be avoided}


\paragraph{SRM}

\todo[inline]{do not (explicitly) discuss clinical application}

The SRM algorithm used in this study has a drawback in that it only models
responses that are common across individuals, without including an individual
component.
%
Although a person's idiosyncratic responses are excluded from the shared
response model, they ``are not necessarily noise and may in fact be highly
reliable within participants'' \citep{cohen2017computational}.
%
Based on the results of this study, it appears that we estimate a regular
pattern in noisy data of a couple of participants  (i.e., we perform an
\ac{srm}-based denoising).
%
However, to predict a reliably deviant pattern, it is necessary to use a
matching CFS from a deviant reference, or preferably, a model that incorporates
a shared response, an individual component, and noise.
%
Future studies should assess the performance of various functional alignment
algorithms in estimating reliably deviant patterns, e.g. atypical topographies
of language areas.
%
Does the algorithm estimate a regular pattern, which allows for quantifying the
difference of a deviant actual pattern from a norm, or does it directly estimate
the deviant pattern from a regular reference?

\todo[inline]{at least two of \citet{feilong2022individualized, jiahui2022cross,
turek2018capturing} have modeled an individual component.}


% citep{cohen2017computational} on SRM and individual residuals
\begin{comment}

\paragraph{SRM and individual differences}
%
``SRM can be used to isolate participant-unique responses by examining the
residuals after removing shared group responses, or it can be applied
hierarchically to the residuals to identify subgroups [\citet{chen2017shared}]
'' \citep{cohen2017computational}.
%
``Recognizing that signal exists beyond the average or shared response of a
group, such studies exploit idiosyncratic but stable responses to account for
previously unexplained variance in brain function, behavioral performance and
clinical measures [e.g., Finn (2015). Functional fingerprinting (based on
connectivity)]'' \citep{cohen2017computational}.
%
``In cases where each subject's unique response is of more interest than the
shared signal, SRM can be used to factor out the shared component thereby
isolating the idiosyncratic response for each subject
[\citep{chen2015reduced}]'' \citep{kumar2020brainiak}.

\end{comment}




\subsubsection{ROI vs. whole-brain}

\todo[inline]{searchlight SRM: \citet{zhang2016searchlight}; negative:
more (hyper) parameters to vary}

``Searchlight functional alignment \citep{zhang2016searchlight,
guntupalli2016model} learns local transformations and aggregates them into a
single large-scale alignment.
%
The searchlight scheme [Kriegeskorte, 2006, Information-based...] , popular in
brain imaging \citep{guntupalli2018computational, guntupalli2016model} has been
used as a way to divide the cortex into small overlapping spheres of a field
radius.
%
This method allows researchers to remain agnostic as to the location of
functional or anatomical boundaries, such as those suggested by
parcellation-based approaches.
%
A local transform can then be learned in each sphere and the full alignment is
obtained by aggregating (e.g. summing as in \citep{guntupalli2016model} or
averaging) across overlapping transforms.
%
The aggregated transformation produced is no longer guaranteed to bear the type
of regularity (e.g orthogonality, isometry, or diffeomorphicity enforced during
the local neighborhood fit)..
%
``In the case of searchlight Procrustes, we selected searchlight parameters to
match those used in Guntupalli et al. (2016):
%
each searchlight had 5 voxel radius, with a 3 voxel distance between searchlight
centers'' \citep{bazeille2021empirical}.


\subsubsection{Volume- vs surface-based}

\todo[inline]{An "issue" for reviewers but, imo, it's not a real issues}

\todo[inline]{opportunity costs: $Z$-maps of localizer were calculated in voxel
space; we are nearer on the raw data (less error accumulation) because we work
with voxels (surface vertices need additional mapping of $Z$-maps calculated
from smoothed data); probably "difficult" to adapt to subcortical structures}

We compare volume-based anatomical alignment to volume-based functional
alignment.
%
Future work could compare surface-based alignment that respects cortical folding
structure -- that out-performs predictions based on [affine] volume-based
anatomical alignment \citep{weiner2018defining} -- to surface-based functional
alignment.


\subsubsection{Time series vs connectivity-based}

\todo[inline]{\citet{jiahui2022cross} do connectivity-based 1-step
hyperalignment across different movie datasets which is as good as response
hyperalignment; however, it's a shitty procedure to scale because it needs a
transformation matrix for every pair of subjects (i.e no \ac{cfs})}

\todo[inline]{just some templates:}

%
``Derivation of this common space can be based on either neural response
profiles (e.g. data collected during tasks, such as movie viewing (Haxby et al.,
2011)) or functional connectivity profiles files
\citep{guntupalli2018computational}.
%
Response-based hyperalignment maps data from the anatomical space to a common
information space based on time-point response patterns across cortical
vertices.
%
Connectivity-based hyperalignment maps data from the anatomical space to a
common information space based on functional connectivity patterns''
\citep{busch2021hybrid}.

%
``The number of voxels that can be considered simultaneously for functional BOLD
response time series alignment is limited by the number of timepoints in the
calibration scan (about 300-400 voxels for a 15min scan with a 2s TR,
corresponding to a local cortical neighborhood of about 1cm in diameter for a
standard resolution).
%
This limitation does not exist in this form for a functional alignment that is
based on connectivity vectors.
%
The length of these connectivity vectors is determined by the number of
reference (or seed) regions in the brain'' [project proposal].


% Kumar on Nastase's ugly mofo paper
``Estimating the SRM from functional connectivity data rather than response time
series circumvents the need for a single shared stimulus across subjects.
%
Connectivity SRM allows us to derive a single shared response space across
different stimuli with a shared connectivity profile
\citep{nastase2019leveraging}'' \citep{kumar2020brainiak}.
%
``The sampling of connectivity vector space is defined by the selection of
connectivity targets, but the richness and reliability of connectivity estimates
depends on the variety of brain states over which connectivity is estimated''
\citep{haxby2020hyperalignment}.


%
``Response-based hyperalignment was shown to align response-based data better
than connectivity-based hyperalignment, whereas connectivity-based
hyperalignment was shown to better align connectivity-based data than
response-based hyperalignment
%
Response-based common spaces better align response data, whereas
connectivity-based common spaces better align connectivity data
\citep{guntupalli2018computational}'' \citep{busch2021hybrid}.


\subsection{Vision}

% A shared calibration scan across datasets could be used to transfer data
% between datasets, a procedure that is easier to accomplish than shared
% subjects across datasets \citep[cf.][an extension of the \ac{srm} for shared
% subjects across datasets]{zhang2018transfer}.


\todo[inline]{probably, write more here regarding the Vision}

\todo[inline]{general discussion is more about pro (functional alignment, yeah!)
\& contra of naturalistic stimuli}

\todo[inline]{do not speak about "clinical application" here, because this is
about estimating deviations}

\subsubsection{Intro}

\todo[inline]{maybe, repeat phrasing from introduction (cf. localizer
paradigms)}

%
Our results suggest that $\approx$\unit[15]{min} functional scanning using an
engaging naturalistic stimulus could provide sufficient data for a
\textit{calibration scan}.
%
A standardized calibration scan could be used to align a new subject to a
\ac{cfs} that was derived from extensive scans of a reference group.
%
The reference group's scans would include data collected from both naturalistic
paradigms and controlled paradigms.
%
The controlled paradigms could include functional localizers that are
specifically designed to reliably map brain processes involved in, for example,
low-level auditory or visual perception, as well as higher cognition, such as
theory of mind or \citep{spunt2014validating} or semantic processes
\citep{fedorenko2010new, fernandez2001language}.
%
The diagnostic run would be based on a multifaceted naturalistic stimulus that
samples a broad range of brain states in order to allow for a valid alignment to
the reference \ac{cfs}.
%
Compared to a diagnostic run based on a controlled paradigm, a naturalistic
stimulus would have the additional benefits of higher engagement and better
compliance \citep{vanderwal2015inscapes, eickhoff2020towards}, especially in
children or patients.


\paragraph{Application: estimate \& quantify regular vs. deviant pattern}

%
Once a new subject is aligned to the \ac{cfs}, the functional patterns collected
in a reference group could be mapped through the \ac{cfs} into the new subject's
voxel space.
%
This would allow for the estimation of regular patterns in the new subject when
additional functional scans are not feasible due to scanner availability, time
limitations, monetary constraints, or compliance issues.
%
Moreover, this approach would allow for the quantification of the similarity (or
difference) of a new subject's actual pattern (i.e., an empirical $Z$-map) to a
pattern estimated from a healthy \textbf{or clinical} reference group.


\todo[inline]{essentially quoting the abstract of \citet{yates2021emergence}:}
%
For instance, a recent study by \citet{yates2021emergence} ``employed shared
response modeling to investigate the presence and localization of adult
functions in children.
%
The authors learned a feature space from fMRI activity of adults watching a
movie and then translated the shared features into the anatomical brain space of
children aged 3 to 12 years old.
%
They found reliable correlations between reconstructed activity and children's
actual fMRI activity as they watched the same movie.
%
The strength of the correlation in the precuneus, inferior frontal gyrus, and
lateral occipital cortex predicted chronological age.
%
This approach demonstrates the potential to generalize findings across different
populations and ages, further highlighting the importance of establishing a
reliable and accurate \ac{cfs}''.



\subsection{Conclusion}

God bless America!


\section{Data Availability}

\todo[inline]{all from PPA-Paper but with new GIN link leading to an empty repo}

% \href{https://gin.g-node.org/chaeusler/studyforrest-ppa-analysis}{\url{gin.g-node.org/chaeusler/studyforrest-ppa-analysis}}

% new; PPA analysis
All fMRI data and results are available as Datalad \citep{halchenko2021datalad}
datasets, published to or linked from the \emph{G-Node GIN} repository
(\href{https://gin.g-node.org/chaeusler/studyforrest-ppa-srm}{\url{gin.g-node.org/chaeusler/studyforrest-ppa-srm}}).
% original
Raw data of the audio-description, movie and visual localizer were originally
published on the \emph{OpenfMRI} portal
(\url{https://legacy.openfmri.org/dataset/ds000113}; \citep{Hanke2014ds000113},
\space \url{https://legacy.openfmri.org/dataset/ds000113d};
\citep{hanke2016ds000113d}).
% visual localizer
Results from the localization of higher visual areas are available as Datalad
datasets at \emph{GitHub}
(\href{https://github.com/psychoinformatics-de/studyforrest-data-visualrois}{\url{github.com/psychoinformatics-de/studyforrest-data-visualrois}}).
% raw data
The realigned participant-specific time series that were used in the current
analyses were derived from the raw data releases and are available as Datalad
datasets at \emph{GitHub}
(\href{https://github.com/psychoinformatics-de/studyforrest-data-aligned}{\url{github.com/psychoinformatics-de/studyforrest-data-aligned}}).
% OpenNeuro
The same data are available in a modified and merged form on OpenNeuro at
\url{https://openneuro.org/datasets/ds000113}.
% NeuroVault for z-maps of SRM
Unthresholded $Z$-maps of all contrasts can be found at
\href{https://identifiers.org/neurovault.collection:12340}{\url{neurovault.org/collections/12340}}.


\section*{Code Availability}

Scripts to generate the results as Datalad \citep{halchenko2021datalad} datasets
are available in a \emph{G-Node GIN} repository
(\href{https://gin.g-node.org/chaeusler/studyforrest-ppa-srm}{\url{gin.g-node.org/chaeusler/studyforrest-ppa-srm}}).


\begin{comment}

\section{Backup of texts regarding "done but not mentioned"}


\subsection{Calculate $Z$-maps mean in the common space already}
%
I also tested averaging $Z$-maps in the \ac{cfs} (i.e.: not in the test
subject's voxel space): similar results
%
In case of anatomical alignment, I did not test averaging data in MNI152 space.


\subsection{Calculate $Z$-map from training subjects' TRs in FEAT}

iirc, I projected all subjects' localizer time series through
model space into test subject voxel space; then, calculated the contrast
with these data (s. scripts 'test/data\_denoise-vis.py' \&
'test/data\_srm-vis-to-ind.py').
%

The problem was: if one wants to test the different transformation matrices (I
only did it with one; imo, based on alignment using the whole audio-description)
it gets totally messy \& computational intensive.
%
Results were similar to the original procedure if not slightly worse.

\end{comment}
